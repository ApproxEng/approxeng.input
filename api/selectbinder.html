

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Binding - approxeng.input.selectbinder &mdash; Approximate Engineering - Input 2.2.0 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    
      <link rel="search" type="application/opensearchdescription+xml" title="Search within Approximate Engineering - Input 2.2.0 documentation" href="../_static/opensearch.xml"/>
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
  

  
    <link rel="top" title="Approximate Engineering - Input 2.2.0 documentation" href="../index.html"/>
        <link rel="up" title="API Documentation" href="../api.html"/>
        <link rel="next" title="PlayStation 3 Controller Support" href="dualshock3.html"/>
        <link rel="prev" title="Common APIs" href="input.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="../index.html" class="fa fa-home"> Approximate Engineering - Input</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Change Log</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-2-2-0">Version 2.2.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-2-1-0">Version 2.1.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-2-0-3-2-0-4">Version 2.0.3, 2.0.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-2-0-2">Version 2.0.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-2-0-1">Version 2.0.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-2-0-0">Version 2.0.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-1-0-7">Version 1.0.7</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-1-0-6">Version 1.0.6</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-1-0-5">Version 1.0.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-1-0-4">Version 1.0.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#version-1-0-2">Version 1.0.2</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../simpleusage.html">Simple Usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../simpleusage.html#connecting-to-a-controller">Connecting to a controller</a></li>
<li class="toctree-l2"><a class="reference internal" href="../simpleusage.html#reading-analogue-axes">Reading Analogue Axes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../simpleusage.html#checking-for-held-buttons">Checking for Held Buttons</a></li>
<li class="toctree-l2"><a class="reference internal" href="../simpleusage.html#reading-multiple-axis-or-button-hold-values">Reading multiple Axis or Button Hold values</a></li>
<li class="toctree-l2"><a class="reference internal" href="../simpleusage.html#querying-button-presses">Querying Button Presses</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../simpleusage.html#standard-names">Standard Names</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../simpleusage.html#button-names">Button Names</a></li>
<li class="toctree-l2"><a class="reference internal" href="../simpleusage.html#axis-names">Axis Names</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../bluetooth.html">Pairing Controllers over Bluetooth</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../bluetooth.html#dependencies">Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bluetooth.html#pairing-with-bluetoothctl">Pairing with Bluetoothctl</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="input.html">Common APIs</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Binding - approxeng.input.selectbinder</a></li>
<li class="toctree-l2"><a class="reference internal" href="dualshock3.html">PlayStation 3 Controller Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="dualshock4.html">PlayStation 4 Controller Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="xboxone.html">XBox-One S Controller Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="rockcandy.html">Rock Candy Controller Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="steamcontroller.html">Steam Controller Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="wii.html">Wii Remote Pro Controller Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="wiimote.html">WiiMote Controller Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="pihut.html">PiHut Controller Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="sf30pro.html">8Bitdo SF30Pro/SN30Pro Controller Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="spacemousepro.html">Wired SpaceMouse Pro Support</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../addingcontrollers.html">Adding support for a new controller type</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../addingcontrollers.html#finding-your-product-and-vendor-id">Finding your product and vendor ID</a></li>
<li class="toctree-l2"><a class="reference internal" href="../addingcontrollers.html#clones-of-a-supported-controller">Clones of a supported controller</a></li>
<li class="toctree-l2"><a class="reference internal" href="../addingcontrollers.html#writing-a-new-controller-class">Writing a new controller class</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples/camjam.html">CamJam Edukit 3 Robot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/failover.html">Controller Failover</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/show_controls.html">Showing Controller Properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/streams.html">Streaming Axis and Button Hold values</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/tiny4wd.html">Tiny4WD Robot Drive</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../howtouse.html">Advanced Usage Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../howtouse.html#constructing-and-binding-a-controller">Constructing and Binding a Controller</a></li>
<li class="toctree-l2"><a class="reference internal" href="../howtouse.html#handling-buttons">Handling Buttons</a></li>
<li class="toctree-l2"><a class="reference internal" href="../howtouse.html#more-about-analogue-axes">More about Analogue Axes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../sys.html">LEDs and Battery Monitoring</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../sys.html#enabling-access-to-leds">Enabling access to LEDs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sys.html#writing-to-leds">Writing to LEDs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sys.html#reading-battery-levels">Reading Battery Levels</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Approximate Engineering - Input</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../api.html">API Documentation</a> &raquo;</li>
      
    <li>Binding - approxeng.input.selectbinder</li>
      <li class="wy-breadcrumbs-aside">
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="binding-approxeng-input-selectbinder">
<span id="binding-reference-label"></span><h1>Binding - approxeng.input.selectbinder<a class="headerlink" href="#binding-approxeng-input-selectbinder" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This replaces the previous approxeng.input.asyncorebinder. The main advantage is that it is compatible with both
Python 2 and 3, removing the only feature of the library that wasn&#8217;t working with Python 3, but it&#8217;s also much
simpler to use. Where the asyncore binder used device names and paths to try to find an appropriate controller, the
new code uses vendor and product identifiers - these are much more consistent and are guaranteed to be unique. You
don&#8217;t need to care about any of these things though, you just need to know that this new version is much easier to
use!</p>
</div>
<p>The binder provides a bridge between the low level operating system representation of your connected controller and the
high level python classes such as <code class="xref py py-class docutils literal"><span class="pre">approxeng.input.dualshock3.DualShock3</span></code> which your code uses. The binder starts
a new thread to pull events out of the operating system and update your controller object, this is the bit that means
you don&#8217;t have to continuously poll the controller, it just updates in the background. It&#8217;s also the thread which calls
any functions you&#8217;ve bound to buttons as event handlers. You can either manually bind the controller yourself (in which
case you&#8217;re also responsible for un-binding it after you&#8217;re done!) or you can use the python &#8216;with&#8217; functionality.</p>
<p>To bind a controller manually you&#8217;ll need both an instance of the controller class, and one or more evdev InputDevice
instances from which events should be extracted. The following code shows use of the &#8216;find_single_controller&#8217; function
to make this reasonably easy:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">approxeng.input.selectbinder</span> <span class="kn">import</span> <span class="n">bind_controller</span>
<span class="kn">from</span> <span class="nn">approxeng.input.dualshock3</span> <span class="kn">import</span> <span class="n">DualShock3</span>
<span class="kn">from</span> <span class="nn">approxeng.input.controllers</span> <span class="kn">import</span> <span class="n">find_single_controller</span>

<span class="c1"># Locate a controller, instantiate it, and retrieve the InputDevice devices with which it&#39;s associated</span>
<span class="c1"># This will raise IOError if it can&#39;t find an appropriate controller</span>
<span class="n">devices</span><span class="p">,</span> <span class="n">controller</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">find_single_controller</span><span class="p">(</span><span class="n">controller_class</span> <span class="o">=</span> <span class="n">DualShock3</span><span class="p">)</span>

<span class="n">unbind_function</span> <span class="o">=</span> <span class="n">bind_controller</span><span class="p">(</span><span class="n">devices</span> <span class="o">=</span> <span class="n">devices</span><span class="p">,</span> <span class="n">controller</span> <span class="o">=</span> <span class="n">controller</span><span class="p">)</span>
<span class="c1"># At this point the joystick object is bound to the device and will receive updates.</span>
<span class="c1"># .... do stuff ....</span>
<span class="c1"># When we&#39;re finished, call the unbind function to free up the resources used by the binder</span>
<span class="n">unbind_function</span><span class="p">()</span>
</pre></div>
</div>
<p>Binding a controller manually works, but there&#8217;s a simpler way to handle the process (and one which avoids ever having
to worry about explicitly unbinding the controller!):</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">approxeng.input.selectbinder</span> <span class="kn">import</span> <span class="n">ControllerResource</span>
<span class="kn">from</span> <span class="nn">approxeng.input.dualshock3</span> <span class="kn">import</span> <span class="n">DualShock3</span>

<span class="c1"># Locate a controller, instantiate it, and retrieve the InputDevice devices with which it&#39;s associated</span>
<span class="c1"># This will raise IOError if it can&#39;t find an appropriate controller</span>
<span class="n">devices</span><span class="p">,</span> <span class="n">controller</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">find_single_controller</span><span class="p">(</span><span class="n">controller_class</span> <span class="o">=</span> <span class="n">DualShock3</span><span class="p">)</span>

<span class="k">with</span> <span class="n">ControllerResource</span><span class="p">(</span><span class="n">devices</span> <span class="o">=</span> <span class="n">devices</span><span class="p">,</span> <span class="n">controller</span> <span class="o">=</span> <span class="n">controller</span><span class="p">)</span> <span class="k">as</span> <span class="n">joystick</span><span class="p">:</span>
    <span class="c1"># .... do stuff, the controller is bound to &#39;joystick&#39; which is a DualShock3 instance....</span>
</pre></div>
</div>
<p>On exit from the &#8216;with&#8217; block the binder is automatically unbound, this includes cases where we break out of the block
because of exceptions or other error conditions. It&#8217;s a simpler and more robust way to handle the binding and I suggest
you use it instead of explicitly binding it yourself.</p>
<p>This still requires you to go and find your controller, in most cases you&#8217;ll only have one controller of a given kind.
There&#8217;s a shorter form of the resource binding that takes advantage of this case:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">approxeng.input.selectbinder</span> <span class="kn">import</span> <span class="n">ControllerResource</span>
<span class="kn">from</span> <span class="nn">approxeng.input.dualshock3</span> <span class="kn">import</span> <span class="n">DualShock3</span>

<span class="c1"># Specifying a controller_class here will search for an attached controller of the given kind</span>
<span class="c1"># If one can&#39;t be found we&#39;ll raise IOError as with the previous code</span>
<span class="k">with</span> <span class="n">ControllerResource</span><span class="p">(</span><span class="n">controller_class</span> <span class="o">=</span> <span class="n">DualShock3</span><span class="p">)</span> <span class="k">as</span> <span class="n">joystick</span><span class="p">:</span>
    <span class="c1"># .... do stuff, the controller is bound to &#39;joystick&#39; which is a DualShock3 instance....</span>
</pre></div>
</div>
<p>This can be made even simpler in the case where you&#8217;re not bothered about what kind of controller you have, or you
explicitly want to be able to work with one of a range of controllers. Omitting the controller_class argument will bind
to the first controller of any kind that&#8217;s found! This, along with the use of standardised names for the axes and
buttons on the controllers, means you can create a robot that works with PS3, PS4 or XBoxOne controllers based on what
you have lying around, very handy for those PiWars moments when your controller dies and you need to borrow one from the
next table along...</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">approxeng.input.selectbinder</span> <span class="kn">import</span> <span class="n">ControllerResource</span>

<span class="c1"># No controller_class is specified, so we look for any joystick from the list we support, and use the first one!</span>
<span class="c1"># If one can&#39;t be found we&#39;ll raise IOError as with the previous code</span>
<span class="k">with</span> <span class="n">ControllerResource</span><span class="p">()</span> <span class="k">as</span> <span class="n">joystick</span><span class="p">:</span>
    <span class="c1"># .... do stuff, the controller is bound to &#39;joystick&#39; is definitely a subclass of Controller but could be</span>
    <span class="c1"># a PS3, PS4, XBoxOne....</span>
</pre></div>
</div>
<div class="section" id="using-an-unsupported-controller">
<h2>Using an Unsupported Controller<a class="headerlink" href="#using-an-unsupported-controller" title="Permalink to this headline">¶</a></h2>
<p>The library&#8217;s automatic detection of controllers relies on vendor and product identifiers. These are IDs allocated by
the USB consortium and won&#8217;t be duplicated in, for example, a clone PS3 controller like the Rock Candy ones. These
controllers therefore won&#8217;t be detected as PS3 controllers even though they&#8217;d respond to the same events. You can,
however, explicitly tell the library to route events from a particular evdev InputDevice to a previously constructed
controller instance. This works with either the explicit binding mechanism or with the resource. You&#8217;ll have to acquire
the appropriate InputDevice from the evdev APIs first, that part&#8217;s up to you, but when you have one you can do this:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">approxeng.input.selectbinder</span> <span class="kn">import</span> <span class="n">ControllerResource</span>
<span class="kn">from</span> <span class="nn">approxeng.input.dualshock3</span> <span class="kn">import</span> <span class="n">DualShock3</span>

<span class="c1"># This is an InputDevice from which events should be pulled</span>
<span class="n">input_device</span> <span class="o">=</span> <span class="o">....</span>

<span class="c1"># Explicitly construct a controller, in this case a PS3 sixaxis. This will receive events from the InputDevice</span>
<span class="c1"># and interpret them. As long as your controller uses the same event codes and axes as those expected by the</span>
<span class="c1"># controller class you should be good to do</span>
<span class="n">controller</span> <span class="o">=</span> <span class="n">DualShock3</span><span class="p">(</span><span class="n">dead_zone</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">hot_zone</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="c1"># Now just use the controller resource to bind the two together, your explicitly created controller instance will</span>
<span class="c1"># be fed events from your InputDevice. The with block returns the controller, so in this case it&#39;s actually the</span>
<span class="c1"># same reference as you just created. You could create the controller instance anonymously as an argument here and</span>
<span class="c1"># use the returned type</span>
<span class="k">with</span> <span class="n">ControllerResource</span><span class="p">(</span><span class="n">devices</span> <span class="o">=</span> <span class="p">[</span><span class="n">input_device</span><span class="p">],</span> <span class="n">controller</span> <span class="o">=</span> <span class="n">controller</span><span class="p">)</span> <span class="k">as</span> <span class="n">joystick</span><span class="p">:</span>
    <span class="c1"># joystick and controller are the same object!</span>
    <span class="c1"># Do stuff as before, if your hardware uses the same codes as the controller class expects it&#39;ll just work.</span>
</pre></div>
</div>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="dualshock3.html" class="btn btn-neutral float-right" title="PlayStation 3 Controller Support">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="input.html" class="btn btn-neutral" title="Common APIs"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Tom Oinn.
      Last updated on Feb 11, 2019.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'2.2.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>