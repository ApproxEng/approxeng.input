

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>approxeng.input &mdash; Approximate Engineering - Input 1.0.7 documentation</title>
  

  
  
  
  

  

  
  
    
      <link rel="search" type="application/opensearchdescription+xml" title="Search within Approximate Engineering - Input 1.0.7 documentation" href="../../_static/opensearch.xml"/>
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="Approximate Engineering - Input 1.0.7 documentation" href="../../index.html"/>
        <link rel="up" title="Module code" href="../index.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> Approximate Engineering - Input
          

          
          </a>

          
            
            
              <div class="version">
                1.0.7
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"></div>
            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Approximate Engineering - Input</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>approxeng.input</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for approxeng.input</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">time</span> <span class="k">import</span> <span class="n">time</span>


<span class="k">def</span> <span class="nf">map_into_range</span><span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">,</span> <span class="n">raw_value</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Map an input function into an output value, clamping such that the magnitude of the output is at most 1.0</span>

<span class="sd">    :param low:</span>
<span class="sd">        The value in the input range corresponding to zero.</span>
<span class="sd">    :param high:</span>
<span class="sd">        The value in the input range corresponding to 1.0 or -1.0, depending on whether this is higher or lower than the</span>
<span class="sd">        low value respectively.</span>
<span class="sd">    :param raw_value:</span>
<span class="sd">        An input value</span>
<span class="sd">    :return:</span>
<span class="sd">        Mapped output value</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">raw_value</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">low</span> <span class="o">&lt;</span> <span class="n">high</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="n">low</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="n">value</span> <span class="o">&gt;</span> <span class="n">high</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">1.0</span>
    <span class="k">elif</span> <span class="n">low</span> <span class="o">&gt;</span> <span class="n">high</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">&gt;</span> <span class="n">low</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="n">high</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">value</span> <span class="o">-</span> <span class="n">low</span><span class="p">)</span> <span class="o">/</span> <span class="nb">abs</span><span class="p">(</span><span class="n">high</span> <span class="o">-</span> <span class="n">low</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">map_single_axis</span><span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">,</span> <span class="n">dead_zone</span><span class="p">,</span> <span class="n">hot_zone</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Apply dead and hot zones before mapping a value to a range. The dead and hot zones are both expressed as the</span>
<span class="sd">    proportion of the axis range which should be regarded as 0.0 or 1.0 (or -1.0 depending on cardinality) respectively,</span>
<span class="sd">    so for example setting dead zone to 0.2 means the first 20% of the range of the axis will be treated as if it&#39;s the</span>
<span class="sd">    low value, and setting the hot zone to 0.4 means the last 40% of the range will be treated as if it&#39;s the high</span>
<span class="sd">    value. Note that as with map_into_range, low is not necessarily numerically lower than high, it instead expresses</span>
<span class="sd">    a low value signal as opposed to a high value one (which could include a high negative value). Note that bad things</span>
<span class="sd">    happen if dead_zone + hot_zone == 1.0, so don&#39;t do that. This is used by the map_dual_axis call, but can also be</span>
<span class="sd">    used by itself to handle single axes like triggers where the overall range varies from 0.0 to 1.0 rather than -1.0</span>
<span class="sd">    to 1.0 as a regular joystick axis would.</span>

<span class="sd">    :param low:</span>
<span class="sd">        The value corresponding to no signal</span>
<span class="sd">    :param high:</span>
<span class="sd">        The value corresponding to a full signal</span>
<span class="sd">    :param dead_zone:</span>
<span class="sd">        The proportion of the range of motion away from the no-signal end which should be treated as equivalent to no</span>
<span class="sd">        signal and return 0.0</span>
<span class="sd">    :param hot_zone:</span>
<span class="sd">        The proportion of the range of motion away from the high signal end which should be treated as equivalent to a</span>
<span class="sd">        full strength input.</span>
<span class="sd">    :param value:</span>
<span class="sd">        The raw value to map</span>
<span class="sd">    :return:</span>
<span class="sd">        The scaled and clipped value, taking into account dead and hot zone boundaries, ranging from 0.0 to either 1.0</span>
<span class="sd">        or -1.0 depending on whether low or high are numerically larger (low &lt; high means max value is 1.0, high &lt; low</span>
<span class="sd">        means it&#39;s -1.0).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">input_range</span> <span class="o">=</span> <span class="n">high</span> <span class="o">-</span> <span class="n">low</span>
    <span class="n">corrected_low</span> <span class="o">=</span> <span class="n">low</span> <span class="o">+</span> <span class="n">input_range</span> <span class="o">*</span> <span class="n">dead_zone</span>
    <span class="n">corrected_high</span> <span class="o">=</span> <span class="n">high</span> <span class="o">-</span> <span class="n">input_range</span> <span class="o">*</span> <span class="n">hot_zone</span>
    <span class="k">return</span> <span class="n">map_into_range</span><span class="p">(</span><span class="n">corrected_low</span><span class="p">,</span> <span class="n">corrected_high</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">map_dual_axis</span><span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">,</span> <span class="n">centre</span><span class="p">,</span> <span class="n">dead_zone</span><span class="p">,</span> <span class="n">hot_zone</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Map an axis with a central dead zone and hot zones at each end to a range from -1.0 to 1.0. This in effect uses two</span>
<span class="sd">    calls to map_single_axis, choosing whether to use centre and low, or centre and high as the low and high values in</span>
<span class="sd">    that call based on which side of the centre value the input value falls. This is the call that handles mapping of</span>
<span class="sd">    values on regular joysticks where there&#39;s a centre point to which the physical control returns when no input is</span>
<span class="sd">    being made.</span>

<span class="sd">    :param low:</span>
<span class="sd">        The raw value corresponding to the strongest negative input (stick far left / down).</span>
<span class="sd">    :param high:</span>
<span class="sd">        The raw value corresponding to the strongest positive input (stick far right / up).</span>
<span class="sd">    :param centre:</span>
<span class="sd">        The raw value corresponding to the resting position of the axis when no user interaction is happening.</span>
<span class="sd">    :param dead_zone:</span>
<span class="sd">        The proportion of each (positive and negative) part of the motion away from the centre which should result in</span>
<span class="sd">        an output of 0.0</span>
<span class="sd">    :param hot_zone:</span>
<span class="sd">        The proportion of each (positive and negative) part of the motion away from each extreme end of the range which</span>
<span class="sd">        should result in 1.0 or -1.0 being returned (depending on whether we&#39;re on the high or low side of the centre</span>
<span class="sd">        point)</span>
<span class="sd">    :param value:</span>
<span class="sd">        The raw value to map</span>
<span class="sd">    :return:</span>
<span class="sd">        The filtered and clamped value, from -1.0 at low to 1.0 at high, with a centre as specified mapping to 0.0</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;=</span> <span class="n">centre</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">map_single_axis</span><span class="p">(</span><span class="n">centre</span><span class="p">,</span> <span class="n">low</span><span class="p">,</span> <span class="n">dead_zone</span><span class="p">,</span> <span class="n">hot_zone</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">map_single_axis</span><span class="p">(</span><span class="n">centre</span><span class="p">,</span> <span class="n">high</span><span class="p">,</span> <span class="n">dead_zone</span><span class="p">,</span> <span class="n">hot_zone</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>


<div class="viewcode-block" id="Controller"><a class="viewcode-back" href="../../api/input.html#approxeng.input.Controller">[docs]</a><span class="k">class</span> <span class="nc">Controller</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Superclass for controller implementations</span>

<span class="sd">    :ivar int vendor_id:</span>
<span class="sd">        Vendor ID used to identify the controller type.</span>
<span class="sd">    :ivar int product_id:</span>
<span class="sd">        Product ID used to identify the controller type.</span>
<span class="sd">    :ivar approxeng.input.Axes axes:</span>
<span class="sd">        All analogue axes. You can get the individual axis objects from this, but you shouldn&#39;t ever need to do this,</span>
<span class="sd">        use methods on Controller instead!</span>
<span class="sd">    :ivar approxeng.input.Buttons buttons:</span>
<span class="sd">        All buttons are managed by this object. This can be used to access Button objects representing buttons on the</span>
<span class="sd">        controller, but you will almost never need to do this - use the methods on Controller instead!</span>
<span class="sd">    :ivar: boolean connected:</span>
<span class="sd">        True if the controller is connected to a source of events, False otherwise. This can be used as a break</span>
<span class="sd">        condition to check for controller disconnection.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Controller.__init__"><a class="viewcode-back" href="../../api/input.html#approxeng.input.Controller.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vendor_id</span><span class="p">,</span> <span class="n">product_id</span><span class="p">,</span> <span class="n">controls</span><span class="p">,</span> <span class="n">dead_zone</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">hot_zone</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Populate the controller name, button set and axis set.</span>

<span class="sd">        :param int vendor_id:</span>
<span class="sd">            The USB vendor ID for the controller</span>
<span class="sd">        :param int product_id:</span>
<span class="sd">            The USB product ID for the controller</span>
<span class="sd">        :param controls:</span>
<span class="sd">            A sequence of Button, CentredAxis, TriggerAxis and BinaryAxis instances</span>
<span class="sd">        :param dead_zone:</span>
<span class="sd">            If specified, this is applied to all axes</span>
<span class="sd">        :param hot_zone:</span>
<span class="sd">            If specified, this is applied to all axes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vendor_id</span> <span class="o">=</span> <span class="n">vendor_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">product_id</span> <span class="o">=</span> <span class="n">product_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="n">Axes</span><span class="p">([</span><span class="n">control</span> <span class="k">for</span> <span class="n">control</span> <span class="ow">in</span> <span class="n">controls</span> <span class="k">if</span>
                          <span class="nb">isinstance</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="n">CentredAxis</span><span class="p">)</span> <span class="ow">or</span>
                          <span class="nb">isinstance</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="n">BinaryAxis</span><span class="p">)</span> <span class="ow">or</span>
                          <span class="nb">isinstance</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="n">TriggerAxis</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buttons</span> <span class="o">=</span> <span class="n">Buttons</span><span class="p">([</span><span class="n">control</span> <span class="k">for</span> <span class="n">control</span> <span class="ow">in</span> <span class="n">controls</span> <span class="k">if</span>
                                <span class="nb">isinstance</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="n">Button</span><span class="p">)</span> <span class="ow">or</span>
                                <span class="nb">isinstance</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="n">BinaryAxis</span><span class="p">)</span> <span class="ow">or</span>
                                <span class="nb">isinstance</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="n">TriggerAxis</span><span class="p">)])</span>
        <span class="k">if</span> <span class="n">dead_zone</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">axis</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">axes</span><span class="p">:</span>
                <span class="n">axis</span><span class="o">.</span><span class="n">dead_zone</span> <span class="o">=</span> <span class="n">dead_zone</span>
        <span class="k">if</span> <span class="n">hot_zone</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">axis</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">axes</span><span class="p">:</span>
                <span class="n">axis</span><span class="o">.</span><span class="n">hot_zone</span> <span class="o">=</span> <span class="n">hot_zone</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connected</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exception</span> <span class="o">=</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="Controller.stream"><a class="viewcode-back" href="../../api/input.html#approxeng.input.Controller.stream">[docs]</a>    <span class="k">def</span> <span class="nf">stream</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a GPIOzero compatible source of axis values. This returns a generator which produces an infinite</span>
<span class="sd">        stream of tuples containing the requested axis values, for example:</span>
<span class="sd">        </span>
<span class="sd">        .. code-block:: python</span>
<span class="sd">        </span>
<span class="sd">            from gpiozero import Robot</span>
<span class="sd">            from approxeng.input.selectbinder import ControllerResource</span>
<span class="sd">            from signal import pause</span>
<span class="sd">            </span>
<span class="sd">            # Create a Robot using GPIO pins on the Pi</span>
<span class="sd">            robot = Robot(left=(18, 27), right=(17, 22))</span>
<span class="sd">            </span>
<span class="sd">            with ControllerResource() as joystick:</span>
<span class="sd">                robot.source = joystick.stream(&#39;ly&#39;,&#39;ry&#39;)</span>
<span class="sd">                pause()</span>
<span class="sd">        </span>
<span class="sd">        :param args: </span>
<span class="sd">            Any number of axis standard names</span>
<span class="sd">        :return: </span>
<span class="sd">            A generator producing an infinite sequence of tuples containing the corrected values for those names</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">connected</span><span class="p">:</span>
            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">args</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Simple index access to axis corrected values and button held times</span>
<span class="sd">        :param item:</span>
<span class="sd">            the sname of an axis or button, or a tuple thereof</span>
<span class="sd">        :return:</span>
<span class="sd">            for an axis, the corrected value, or, for a button, the held time or None if not held. Raises AttributeError</span>
<span class="sd">            if the given name doesn&#39;t correspond to an axis or a button. If a tuple is supplied as an argument, result</span>
<span class="sd">            will be a tuple of values.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="fm">__getattr__</span><span class="p">(</span><span class="n">single_item</span><span class="p">)</span> <span class="k">for</span> <span class="n">single_item</span> <span class="ow">in</span> <span class="n">item</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__getattr__</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Property access to axis values and button hold times</span>

<span class="sd">        :param item:</span>
<span class="sd">            sname of an axis or button</span>
<span class="sd">        :return:</span>
<span class="sd">            The axis corrected value, or button hold time (None if not held), or AttributeError if sname not found</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
        <span class="k">elif</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">buttons</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">buttons</span><span class="o">.</span><span class="n">held</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span>

    <span class="k">def</span> <span class="nf">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A Controller contains a named attribute if it has either an axis or a button with the attribute as its sname</span>
<span class="sd">        :param item:</span>
<span class="sd">            The sname of the button or axis</span>
<span class="sd">        :return:</span>
<span class="sd">            True if there&#39;s a button or axis with that name, false otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">buttons</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

<div class="viewcode-block" id="Controller.check_presses"><a class="viewcode-back" href="../../api/input.html#approxeng.input.Controller.check_presses">[docs]</a>    <span class="k">def</span> <span class="nf">check_presses</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the set of Buttons which have been pressed since this call was last made, clearing it as we do. This is</span>
<span class="sd">        a shortcut do doing &#39;buttons.get_and_clear_button_press_history&#39;</span>
<span class="sd">    </span>
<span class="sd">        :return:</span>
<span class="sd">            A ButtonPresses instance which contains buttons which were pressed since this call was last made.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">buttons</span><span class="o">.</span><span class="n">check_presses</span><span class="p">()</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">has_presses</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">buttons</span><span class="o">.</span><span class="n">presses</span><span class="o">.</span><span class="n">has_presses</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">presses</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The ButtonPresses containing buttons pressed between the two most recent calls to check_presses</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">buttons</span><span class="o">.</span><span class="n">presses</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">controls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :return:</span>
<span class="sd">            A struct containing all the names of controls on this controller</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;axes&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">names</span><span class="p">,</span>
                <span class="s1">&#39;buttons&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">buttons</span><span class="o">.</span><span class="n">names</span><span class="p">}</span>

<div class="viewcode-block" id="Controller.register_button_handler"><a class="viewcode-back" href="../../api/input.html#approxeng.input.Controller.register_button_handler">[docs]</a>    <span class="k">def</span> <span class="nf">register_button_handler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">button_handler</span><span class="p">,</span> <span class="n">button_sname</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Register a handler function which will be called when a button is pressed</span>

<span class="sd">        :param button_handler:</span>
<span class="sd">            A function which will be called when any of the specified buttons are pressed. The</span>
<span class="sd">            function is called with the Button that was pressed as the sole argument.</span>
<span class="sd">        :param button_sname:</span>
<span class="sd">            The sname of the button which should trigger the handler function</span>
<span class="sd">        :return:</span>
<span class="sd">            A no-arg function which can be used to remove this registration</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">buttons</span><span class="o">.</span><span class="n">register_button_handler</span><span class="p">(</span><span class="n">button_handler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">buttons</span><span class="p">[</span><span class="n">button_sname</span><span class="p">])</span></div>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">, axes=</span><span class="si">{}</span><span class="s2">, buttons=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">buttons</span><span class="p">)</span></div>


<div class="viewcode-block" id="Axes"><a class="viewcode-back" href="../../api/input.html#approxeng.input.Axes">[docs]</a><span class="k">class</span> <span class="nc">Axes</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A set of TriggerAxis or CentredAxis instances to which events should be routed based on event code. Contains methods</span>
<span class="sd">    to reset calibration on all axes, or to centre all axes for which this is meaningful.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Axes.__init__"><a class="viewcode-back" href="../../api/input.html#approxeng.input.Axes.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axes</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a new Axes instance, this will be done within the controller classes, you never have to explicitly</span>
<span class="sd">        instantiate this yourself.</span>

<span class="sd">        :param axes:</span>
<span class="sd">            a sequence of :class:`approxeng.input.TriggerAxis` or :class:`approxeng.input.CentredAxis` or </span>
<span class="sd">            :class:`approxeng.input.BinaryAxis` containing all the axes the controller supports.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes_by_code</span> <span class="o">=</span> <span class="p">{</span><span class="n">axis</span><span class="o">.</span><span class="n">axis_event_code</span><span class="p">:</span> <span class="n">axis</span> <span class="k">for</span> <span class="n">axis</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes_by_sname</span> <span class="o">=</span> <span class="p">{</span><span class="n">axis</span><span class="o">.</span><span class="n">sname</span><span class="p">:</span> <span class="n">axis</span> <span class="k">for</span> <span class="n">axis</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">}</span></div>

<div class="viewcode-block" id="Axes.axis_updated"><a class="viewcode-back" href="../../api/input.html#approxeng.input.Axes.axis_updated">[docs]</a>    <span class="k">def</span> <span class="nf">axis_updated</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Called to process an absolute axis event from evdev, this is called internally by the controller implementations</span>

<span class="sd">        :internal:</span>

<span class="sd">        :param event:</span>
<span class="sd">            The evdev event to process</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes_by_code</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">code</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">axis</span><span class="o">.</span><span class="n">set_raw_value</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Unknown axis code </span><span class="si">{}</span><span class="s1">, value </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">code</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">value</span><span class="p">))</span></div>

<div class="viewcode-block" id="Axes.set_axis_centres"><a class="viewcode-back" href="../../api/input.html#approxeng.input.Axes.set_axis_centres">[docs]</a>    <span class="k">def</span> <span class="nf">set_axis_centres</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the centre points for each axis to the current value for that axis. This centre value is used when</span>
<span class="sd">        computing the value for the axis and is subtracted before applying any scaling. This will only be applied</span>
<span class="sd">        to CentredAxis instances</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">axis</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes_by_code</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">CentredAxis</span><span class="p">):</span>
                <span class="n">axis</span><span class="o">.</span><span class="n">centre</span> <span class="o">=</span> <span class="n">axis</span><span class="o">.</span><span class="n">value</span></div>

<div class="viewcode-block" id="Axes.reset_axis_calibration"><a class="viewcode-back" href="../../api/input.html#approxeng.input.Axes.reset_axis_calibration">[docs]</a>    <span class="k">def</span> <span class="nf">reset_axis_calibration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Resets any previously defined axis calibration to 0.0 for all axes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">axis</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">:</span>
            <span class="n">axis</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">axis</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">axis</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">axis</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes_by_code</span><span class="o">.</span><span class="n">values</span><span class="p">())</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The snames of all axis objects</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes_by_sname</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="s1">&#39;&#39;</span><span class="p">])</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">active_axes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a sequence of all Axis objects which are not in their resting positions</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">axis</span> <span class="k">for</span> <span class="n">axis</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="k">if</span> <span class="n">axis</span><span class="o">.</span><span class="n">value</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sname</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get an axis by sname, if present</span>

<span class="sd">        :param sname:</span>
<span class="sd">            The standard name to search</span>
<span class="sd">        :return:</span>
<span class="sd">            An axis object, or None if no such button exists</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes_by_sname</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">sname</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Called when an unresolved attribute is requested, retrieves the Axis object for the given sname</span>

<span class="sd">        :param item:</span>
<span class="sd">            the standard name of the axis to query</span>
<span class="sd">        :return:</span>
<span class="sd">            the corrected value of the axis, or raise AttributeError if no such axis is present</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Search for </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes_by_sname</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span>

    <span class="k">def</span> <span class="nf">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check whether a given axis, referenced by sname, exists</span>

<span class="sd">        :param item:</span>
<span class="sd">            The sname of the axis to search</span>
<span class="sd">        :return:</span>
<span class="sd">            True if the axis exists, false otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes_by_sname</span></div>


<div class="viewcode-block" id="TriggerAxis"><a class="viewcode-back" href="../../api/input.html#approxeng.input.TriggerAxis">[docs]</a><span class="k">class</span> <span class="nc">TriggerAxis</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A single analogue axis where the expected output range is 0.0 to 1.0. Typically this is used for triggers, where the</span>
<span class="sd">    resting position is 0.0 and any interaction causes higher values. Whether a particular controller exposes triggers</span>
<span class="sd">    as axes or as buttons depends on the hardware - the PS3 front triggers appear as buttons, the XBox One triggers as</span>
<span class="sd">    axes.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="TriggerAxis.__init__"><a class="viewcode-back" href="../../api/input.html#approxeng.input.TriggerAxis.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">min_raw_value</span><span class="p">,</span> <span class="n">max_raw_value</span><span class="p">,</span> <span class="n">axis_event_code</span><span class="p">,</span> <span class="n">dead_zone</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">hot_zone</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">sname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">button_sname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">button_trigger_value</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a new TriggerAxis - this will be done internally within the controller classes i.e.</span>
<span class="sd">        :class:`approxeng.input.xboxone.XBoxOneSPad`</span>

<span class="sd">        :param name:</span>
<span class="sd">            A friendly name for the axis</span>
<span class="sd">        :param min_raw_value:</span>
<span class="sd">            The value read from the event system when the trigger is not pressed</span>
<span class="sd">        :param max_raw_value:</span>
<span class="sd">            The value read from the event system when the trigger is fully pressed</span>
<span class="sd">        :param axis_event_code:</span>
<span class="sd">            The evdev code for this axis, used when dispatching events to it from an Axes object</span>
<span class="sd">        :param dead_zone:</span>
<span class="sd">            The proportion of the trigger range which will be treated as equivalent to no press</span>
<span class="sd">        :param hot_zone:</span>
<span class="sd">            The proportion of the trigger range which will be treated as equivalent to fully depressing the trigger</span>
<span class="sd">        :param sname:</span>
<span class="sd">            The standard name for this trigger, if specified</span>
<span class="sd">        :param button_sname:</span>
<span class="sd">            If provided, this creates a new Button internally which will be triggered by changes to the axis value. This</span>
<span class="sd">            is useful for triggers which have axis representations but no corresponding button presses such as the XBox1</span>
<span class="sd">            controller front triggers. If this is set to None then no button is created</span>
<span class="sd">        :param button_trigger_value:</span>
<span class="sd">            Defaulting to 0.5, this value determines the point in the trigger axis&#39; range at which point the button is</span>
<span class="sd">            regarded as being pressed or released.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="mf">0.9</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span> <span class="mf">0.1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dead_zone</span> <span class="o">=</span> <span class="n">dead_zone</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hot_zone</span> <span class="o">=</span> <span class="n">hot_zone</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_raw_value</span> <span class="o">=</span> <span class="n">min_raw_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_raw_value</span> <span class="o">=</span> <span class="n">max_raw_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axis_event_code</span> <span class="o">=</span> <span class="n">axis_event_code</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sname</span> <span class="o">=</span> <span class="n">sname</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buttons</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">button_trigger_value</span> <span class="o">=</span> <span class="n">button_trigger_value</span>
        <span class="k">if</span> <span class="n">button_sname</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">button</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_trigger_button&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">),</span>
                                 <span class="n">key_code</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_trigger_button&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">axis_event_code</span><span class="p">),</span>
                                 <span class="n">sname</span><span class="o">=</span><span class="n">button_sname</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">button</span> <span class="o">=</span> <span class="kc">None</span></div>

    <span class="k">def</span> <span class="nf">_input_to_raw_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert the value read from evdev to a 0.0 to 1.0 range.</span>

<span class="sd">        :internal:</span>

<span class="sd">        :param value:</span>
<span class="sd">            a value ranging from the defined minimum to the defined maximum value.</span>
<span class="sd">        :return:</span>
<span class="sd">            0.0 at minumum, 1.0 at maximum, linearly interpolating between those two points.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_raw_value</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_raw_value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">raw_value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get an uncorrected value for this trigger</span>

<span class="sd">        :return: a float value, 0.0 when not pressed, to 1.0 when fully pressed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get a centre-compensated, scaled, value for the axis, taking any dead-zone into account. The value will</span>
<span class="sd">        scale from 0.0 at the edge of the dead-zone to 1.0 (positive) at the extreme position of</span>
<span class="sd">        the trigger or the edge of the hot zone, if defined as other than 1.0.</span>

<span class="sd">        :return:</span>
<span class="sd">            a float value, 0.0 when not pressed or within the dead zone, to 1.0 when fully pressed or in the hot zone</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">map_single_axis</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dead_zone</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">hot_zone</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__value</span><span class="p">)</span>

<div class="viewcode-block" id="TriggerAxis.reset"><a class="viewcode-back" href="../../api/input.html#approxeng.input.TriggerAxis.reset">[docs]</a>    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reset calibration (max, min and centre values) for this axis specifically.</span>

<span class="sd">        :internal:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="mf">0.9</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span> <span class="mf">0.1</span></div>

<div class="viewcode-block" id="TriggerAxis.set_raw_value"><a class="viewcode-back" href="../../api/input.html#approxeng.input.TriggerAxis.set_raw_value">[docs]</a>    <span class="k">def</span> <span class="nf">set_raw_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw_value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set a new value, called from within the joystick implementation class when parsing the event queue.</span>

<span class="sd">        :param raw_value: the raw value from the joystick hardware</span>

<span class="sd">        :internal:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_to_raw_value</span><span class="p">(</span><span class="n">raw_value</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">button</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">new_value</span> <span class="o">&gt;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_trigger_value</span> <span class="o">+</span> <span class="mf">0.05</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">__value</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">buttons</span><span class="o">.</span><span class="n">button_pressed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button</span><span class="o">.</span><span class="n">key_code</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">new_value</span> <span class="o">&lt;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button_trigger_value</span> <span class="o">-</span> <span class="mf">0.05</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">__value</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">buttons</span><span class="o">.</span><span class="n">button_released</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">button</span><span class="o">.</span><span class="n">key_code</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__value</span> <span class="o">=</span> <span class="n">new_value</span>
        <span class="k">if</span> <span class="n">new_value</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="n">new_value</span>
        <span class="k">elif</span> <span class="n">new_value</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span> <span class="n">new_value</span></div>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;TriggerAxis name=</span><span class="si">{}</span><span class="s2">, sname=</span><span class="si">{}</span><span class="s2">, corrected_value=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sname</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span></div>


<div class="viewcode-block" id="BinaryAxis"><a class="viewcode-back" href="../../api/input.html#approxeng.input.BinaryAxis">[docs]</a><span class="k">class</span> <span class="nc">BinaryAxis</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A fake &#39;analogue&#39; axis which actually corresponds to a pair of buttons. Once associated with a Buttons instance</span>
<span class="sd">    it routes events through to the Buttons instance to create button presses corresponding to axis movements.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="BinaryAxis.__init__"><a class="viewcode-back" href="../../api/input.html#approxeng.input.BinaryAxis.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">axis_event_code</span><span class="p">,</span> <span class="n">b1name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">b2name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a new binary axis, used to route axis events through to a pair of buttons, which are created as</span>
<span class="sd">        part of this constructor</span>
<span class="sd">        </span>
<span class="sd">        :param name: </span>
<span class="sd">            Name for the axis, use this to describe the axis, it&#39;s not used for anything else</span>
<span class="sd">        :param axis_event_code: </span>
<span class="sd">            The evdev event code for changes to this axis</span>
<span class="sd">        :param b1name: </span>
<span class="sd">            The sname of the button corresponding to negative values of the axis.</span>
<span class="sd">        :param b2name: </span>
<span class="sd">            The sname of the button corresponding to positive values of the axis</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axis_event_code</span> <span class="o">=</span> <span class="n">axis_event_code</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b1</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_left_button&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">),</span> <span class="n">key_code</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_left&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">axis_event_code</span><span class="p">),</span> <span class="n">sname</span><span class="o">=</span><span class="n">b1name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b2</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_right_button&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">),</span> <span class="n">key_code</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_right&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">axis_event_code</span><span class="p">),</span> <span class="n">sname</span><span class="o">=</span><span class="n">b2name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buttons</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_value</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sname</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__value</span> <span class="o">=</span> <span class="mi">0</span></div>

    <span class="k">def</span> <span class="nf">set_raw_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw_value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__value</span> <span class="o">=</span> <span class="n">raw_value</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">buttons</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_value</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">buttons</span><span class="o">.</span><span class="n">button_released</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b1</span><span class="o">.</span><span class="n">key_code</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_value</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">buttons</span><span class="o">.</span><span class="n">button_released</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b2</span><span class="o">.</span><span class="n">key_code</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">last_value</span> <span class="o">=</span> <span class="n">raw_value</span>
            <span class="k">if</span> <span class="n">raw_value</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">buttons</span><span class="o">.</span><span class="n">button_pressed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b1</span><span class="o">.</span><span class="n">key_code</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">raw_value</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">buttons</span><span class="o">.</span><span class="n">button_pressed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b2</span><span class="o">.</span><span class="n">key_code</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__value</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;BinaryAxis name=</span><span class="si">{}</span><span class="s2">, sname=</span><span class="si">{}</span><span class="s2">, corrected_value=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sname</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span></div>


<div class="viewcode-block" id="CentredAxis"><a class="viewcode-back" href="../../api/input.html#approxeng.input.CentredAxis">[docs]</a><span class="k">class</span> <span class="nc">CentredAxis</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A single analogue axis on a controller where the expected output range is -1.0 to 1.0 and the resting position of</span>
<span class="sd">    the control is at 0.0, at least in principle.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="CentredAxis.__init__"><a class="viewcode-back" href="../../api/input.html#approxeng.input.CentredAxis.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">min_raw_value</span><span class="p">,</span> <span class="n">max_raw_value</span><span class="p">,</span> <span class="n">axis_event_code</span><span class="p">,</span> <span class="n">invert</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dead_zone</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">hot_zone</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                 <span class="n">sname</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a new CentredAxis - this will be done internally within the controller classes i.e.</span>
<span class="sd">        :class:`approxeng.input.sixaxis.SixAxis`</span>

<span class="sd">        :param name:</span>
<span class="sd">            A friendly name for the axis</span>
<span class="sd">        :param min_raw_value:</span>
<span class="sd">            The value read from the event system when the axis is at its minimum value</span>
<span class="sd">        :param max_raw_value:</span>
<span class="sd">            The value read from the event system when the axis is at its maximum value</span>
<span class="sd">        :param axis_event_code:</span>
<span class="sd">            The evdev code for this axis, used to dispatch events to the axis from the event system</span>
<span class="sd">        :param invert:</span>
<span class="sd">            True to invert data, used when the raw data is in the opposite sense to normal</span>
<span class="sd">        :param dead_zone:</span>
<span class="sd">            Size of the dead zone in the centre of the axis, within which all values will be mapped to 0.0</span>
<span class="sd">        :param hot_zone:</span>
<span class="sd">            Size of the hot zones at the ends of the axis, where values will be mapped to -1.0 or 1.0</span>
<span class="sd">        :param sname:</span>
<span class="sd">            The standard name for this axis, if specified</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">centre</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="mf">0.9</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.9</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__value</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">invert</span> <span class="o">=</span> <span class="n">invert</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dead_zone</span> <span class="o">=</span> <span class="n">dead_zone</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hot_zone</span> <span class="o">=</span> <span class="n">hot_zone</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_raw_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">min_raw_value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_raw_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">max_raw_value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axis_event_code</span> <span class="o">=</span> <span class="n">axis_event_code</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sname</span> <span class="o">=</span> <span class="n">sname</span></div>

    <span class="k">def</span> <span class="nf">_input_to_raw_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert the value read from evdev to a -1.0 to 1.0 range.</span>

<span class="sd">        :internal:</span>

<span class="sd">        :param value:</span>
<span class="sd">            a value ranging from the defined minimum to the defined maximum value.</span>
<span class="sd">        :return:</span>
<span class="sd">            -1.0 at minumum, 1.0 at maximum, linearly interpolating between those two points.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># print &quot;Axis change : {} now {}&quot;.format(self.__str__(), value)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_raw_value</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_raw_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_raw_value</span><span class="p">))</span> <span class="o">-</span> <span class="mf">1.0</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">raw_value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get an uncorrected value for this axis</span>

<span class="sd">        :return: a float value, negative to the left or down, and ranging from -1.0 to 1.0</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get a centre-compensated, scaled, value for the axis, taking any dead-zone into account. The value will</span>
<span class="sd">        scale from 0.0 at the edge of the dead-zone to 1.0 (positive) or -1.0 (negative) at the extreme position of</span>
<span class="sd">        the controller or the edge of the hot zone, if defined as other than 1.0. The axis will auto-calibrate for</span>
<span class="sd">        maximum value, initially it will behave as if the highest possible value from the hardware is 0.9 in each</span>
<span class="sd">        direction, and will expand this as higher values are observed. This is scaled by this function and should</span>
<span class="sd">        always return 1.0 or -1.0 at the extreme ends of the axis.</span>

<span class="sd">        :return: a float value, negative to the left or down and ranging from -1.0 to 1.0</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mapped_value</span> <span class="o">=</span> <span class="n">map_dual_axis</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">centre</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dead_zone</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">hot_zone</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__value</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">invert</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="n">mapped_value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">mapped_value</span>

<div class="viewcode-block" id="CentredAxis.reset"><a class="viewcode-back" href="../../api/input.html#approxeng.input.CentredAxis.reset">[docs]</a>    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reset calibration (max, min and centre values) for this axis specifically. Not generally needed, you can just</span>
<span class="sd">        call the reset method on the SixAxis instance.</span>

<span class="sd">        :internal:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">centre</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="mf">0.9</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.9</span></div>

<div class="viewcode-block" id="CentredAxis.set_raw_value"><a class="viewcode-back" href="../../api/input.html#approxeng.input.CentredAxis.set_raw_value">[docs]</a>    <span class="k">def</span> <span class="nf">set_raw_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw_value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set a new value, called from within the joystick implementation class when parsing the event queue.</span>

<span class="sd">        :param raw_value: the raw value from the joystick hardware</span>

<span class="sd">        :internal:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">new_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_to_raw_value</span><span class="p">(</span><span class="n">raw_value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__value</span> <span class="o">=</span> <span class="n">new_value</span>
        <span class="c1"># print &quot;raw={}, val={}&quot;.format(raw_value, self.value)</span>
        <span class="k">if</span> <span class="n">new_value</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="n">new_value</span>
        <span class="k">elif</span> <span class="n">new_value</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">min</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span> <span class="n">new_value</span></div>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;CentredAxis name=</span><span class="si">{}</span><span class="s2">, sname=</span><span class="si">{}</span><span class="s2">, corrected_value=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sname</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span></div>


<div class="viewcode-block" id="Button"><a class="viewcode-back" href="../../api/input.html#approxeng.input.Button">[docs]</a><span class="k">class</span> <span class="nc">Button</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A single button on a controller</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Button.__init__"><a class="viewcode-back" href="../../api/input.html#approxeng.input.Button.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">key_code</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sname</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a new Button - this will be done by the controller implementation classes, you shouldn&#39;t create your own</span>
<span class="sd">        unless you&#39;re writing such a class.</span>

<span class="sd">        :param name:</span>
<span class="sd">            A friendly name for the button</span>
<span class="sd">        :param key_code:</span>
<span class="sd">            The key code for the button, typically an integer used within the button press and release events. Defaults</span>
<span class="sd">            to None if not used.</span>
<span class="sd">        :param sname:</span>
<span class="sd">            The standard name for the button, if available.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">key_code</span> <span class="o">=</span> <span class="n">key_code</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sname</span> <span class="o">=</span> <span class="n">sname</span></div>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Button(name=</span><span class="si">{}</span><span class="s2">, code=</span><span class="si">{}</span><span class="s2">, sname=</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">key_code</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sname</span><span class="p">)</span></div>


<div class="viewcode-block" id="ButtonPresses"><a class="viewcode-back" href="../../api/input.html#approxeng.input.ButtonPresses">[docs]</a><span class="k">class</span> <span class="nc">ButtonPresses</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Stores the set of buttons pressed within a given time interval</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="ButtonPresses.__init__"><a class="viewcode-back" href="../../api/input.html#approxeng.input.ButtonPresses.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">buttons</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buttons</span> <span class="o">=</span> <span class="n">buttons</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">([</span><span class="n">button</span><span class="o">.</span><span class="n">sname</span> <span class="k">for</span> <span class="n">button</span> <span class="ow">in</span> <span class="n">buttons</span><span class="p">])</span></div>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return true if a button was pressed, referencing by standard name</span>
<span class="sd">        </span>
<span class="sd">        :param sname: the name to check</span>
<span class="sd">        :return: true if contained within the press set, false otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[(</span><span class="n">single_item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span> <span class="k">for</span> <span class="n">single_item</span> <span class="ow">in</span> <span class="n">item</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span>

    <span class="k">def</span> <span class="nf">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Simpler way to query whether a button was pressed by overriding the __getattr__ method</span>

<span class="sd">        :param item:</span>
<span class="sd">            sname of the button</span>
<span class="sd">        :return:</span>
<span class="sd">            true if the button was pressed, false if it either wasn&#39;t pressed or wasn&#39;t included in the controller</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span>

    <span class="k">def</span> <span class="nf">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Contains check for a button sname</span>

<span class="sd">        :param item:</span>
<span class="sd">            The sname of the button to check</span>
<span class="sd">        :return:</span>
<span class="sd">            True if the button is in the set of pressed buttons, false otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span>

    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">has_presses</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span></div>


<div class="viewcode-block" id="Buttons"><a class="viewcode-back" href="../../api/input.html#approxeng.input.Buttons">[docs]</a><span class="k">class</span> <span class="nc">Buttons</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A set of buttons on a controller. This class manages event binding and triggering, as well as monitoring button</span>
<span class="sd">    states and tracking whether buttons are held down, and how long if so. Controller implementations instantiate and</span>
<span class="sd">    configure an instance of this class when they want to provide button information, the controller is responsible for</span>
<span class="sd">    translating button events from the underlying operating system frameworks and updating this object appropriately,</span>
<span class="sd">    user code (i.e. your code if you&#39;re reading this) uses the methods on this object to react to button presses.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Buttons.__init__"><a class="viewcode-back" href="../../api/input.html#approxeng.input.Buttons.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">buttons_and_axes</span><span class="p">,</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instantiate a new button manager</span>

<span class="sd">        :param buttons_and_axes:</span>
<span class="sd">            a list of :class:`approxeng.input.Button` instances which will be managed by this class</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">buttons</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">thing</span> <span class="ow">in</span> <span class="n">buttons_and_axes</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">thing</span><span class="p">,</span> <span class="n">Button</span><span class="p">):</span>
                <span class="n">buttons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thing</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">thing</span><span class="p">,</span> <span class="n">BinaryAxis</span><span class="p">):</span>
                <span class="n">buttons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thing</span><span class="o">.</span><span class="n">b1</span><span class="p">)</span>
                <span class="n">buttons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thing</span><span class="o">.</span><span class="n">b2</span><span class="p">)</span>
                <span class="n">thing</span><span class="o">.</span><span class="n">buttons</span> <span class="o">=</span> <span class="bp">self</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">thing</span><span class="p">,</span> <span class="n">TriggerAxis</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">thing</span><span class="o">.</span><span class="n">button</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">buttons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">thing</span><span class="o">.</span><span class="n">button</span><span class="p">)</span>
                    <span class="n">thing</span><span class="o">.</span><span class="n">buttons</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buttons</span> <span class="o">=</span> <span class="p">{</span><span class="n">button</span><span class="p">:</span> <span class="n">Buttons</span><span class="o">.</span><span class="n">ButtonState</span><span class="p">(</span><span class="n">button</span><span class="p">)</span> <span class="k">for</span> <span class="n">button</span> <span class="ow">in</span> <span class="n">buttons</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buttons_by_code</span> <span class="o">=</span> <span class="p">{</span><span class="n">button</span><span class="o">.</span><span class="n">key_code</span><span class="p">:</span> <span class="n">state</span> <span class="k">for</span> <span class="n">button</span><span class="p">,</span> <span class="n">state</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">buttons</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buttons_by_sname</span> <span class="o">=</span> <span class="p">{</span><span class="n">button</span><span class="o">.</span><span class="n">sname</span><span class="p">:</span> <span class="n">state</span> <span class="k">for</span> <span class="n">button</span><span class="p">,</span> <span class="n">state</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">buttons</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__presses</span> <span class="o">=</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="Buttons.ButtonState"><a class="viewcode-back" href="../../api/input.html#approxeng.input.Buttons.ButtonState">[docs]</a>    <span class="k">class</span> <span class="nc">ButtonState</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Per-button state, including any handlers registered, whether the button was pressed since the last call to</span>
<span class="sd">        check, whether it is currently pressed, and the timestamp of the last button press. From this we can handle all</span>
<span class="sd">        possible forms of interaction required.</span>
<span class="sd">        &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Buttons.ButtonState.__init__"><a class="viewcode-back" href="../../api/input.html#approxeng.input.Buttons.ButtonState.__init__">[docs]</a>        <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">button</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">button_handlers</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">is_pressed</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">was_pressed_since_last_check</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">last_pressed</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">button</span> <span class="o">=</span> <span class="n">button</span></div></div>

<div class="viewcode-block" id="Buttons.button_pressed"><a class="viewcode-back" href="../../api/input.html#approxeng.input.Buttons.button_pressed">[docs]</a>    <span class="k">def</span> <span class="nf">button_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_code</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Called from the controller classes to update the state of this button manager when a button is pressed.</span>

<span class="sd">        :internal:</span>

<span class="sd">        :param key_code:</span>
<span class="sd">            The code specified when populating Button instances</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">buttons_by_code</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key_code</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">state</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">handler</span> <span class="ow">in</span> <span class="n">state</span><span class="o">.</span><span class="n">button_handlers</span><span class="p">:</span>
                <span class="n">handler</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">button</span><span class="p">)</span>
            <span class="n">state</span><span class="o">.</span><span class="n">is_pressed</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">state</span><span class="o">.</span><span class="n">last_pressed</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
            <span class="n">state</span><span class="o">.</span><span class="n">was_pressed_since_last_check</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Unknown button code </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key_code</span><span class="p">))</span></div>

<div class="viewcode-block" id="Buttons.button_released"><a class="viewcode-back" href="../../api/input.html#approxeng.input.Buttons.button_released">[docs]</a>    <span class="k">def</span> <span class="nf">button_released</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_code</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Called from the controller classes to update the state of this button manager when a button is released.</span>

<span class="sd">        :internal:</span>

<span class="sd">        :param key_code:</span>
<span class="sd">            The code specified when populating Button instances</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">buttons_by_code</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key_code</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">state</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">state</span><span class="o">.</span><span class="n">is_pressed</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">state</span><span class="o">.</span><span class="n">last_pressed</span> <span class="o">=</span> <span class="kc">None</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The snames of all button objects</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">buttons_by_sname</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="s1">&#39;&#39;</span><span class="p">])</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">presses</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the ButtonPresses containing buttons pressed between the most recent two calls to check_presses. This will</span>
<span class="sd">        call the check_presses method if it has never been called before, and is therefore always safe even if your code</span>
<span class="sd">        has never called the update function. To make this property actually do something useful, however, you do need</span>
<span class="sd">        to call check_presses, preferably once immediately before you then want to handle any button presses that may</span>
<span class="sd">        have happened.</span>

<span class="sd">        :return:</span>
<span class="sd">            a ButtonPresses object containing information about which buttons were pressed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__presses</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">check_presses</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__presses</span>

<div class="viewcode-block" id="Buttons.check_presses"><a class="viewcode-back" href="../../api/input.html#approxeng.input.Buttons.check_presses">[docs]</a>    <span class="k">def</span> <span class="nf">check_presses</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the set of Buttons which have been pressed since this call was last made, clearing it as we do.</span>

<span class="sd">        :return:</span>
<span class="sd">            A ButtonPresses instance which contains buttons which were pressed since this call was last made.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pressed</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">button</span><span class="p">,</span> <span class="n">state</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">buttons</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">state</span><span class="o">.</span><span class="n">was_pressed_since_last_check</span><span class="p">:</span>
                <span class="n">pressed</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">button</span><span class="p">)</span>
                <span class="n">state</span><span class="o">.</span><span class="n">was_pressed_since_last_check</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__presses</span> <span class="o">=</span> <span class="n">ButtonPresses</span><span class="p">(</span><span class="n">pressed</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__presses</span></div>

<div class="viewcode-block" id="Buttons.held"><a class="viewcode-back" href="../../api/input.html#approxeng.input.Buttons.held">[docs]</a>    <span class="k">def</span> <span class="nf">held</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sname</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determines whether a button is currently held, identifying it by standard name</span>
<span class="sd">        </span>
<span class="sd">        :param sname: </span>
<span class="sd">            The standard name of the button</span>
<span class="sd">        :return: </span>
<span class="sd">            None if the button is not held down, or is not available, otherwise the number of seconds as a floating</span>
<span class="sd">            point value since it was pressed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">buttons_by_sname</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">sname</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">state</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">state</span><span class="o">.</span><span class="n">is_pressed</span> <span class="ow">and</span> <span class="n">state</span><span class="o">.</span><span class="n">last_pressed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">state</span><span class="o">.</span><span class="n">last_pressed</span>
        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get a button by sname, if present</span>
<span class="sd">        </span>
<span class="sd">        :param item:</span>
<span class="sd">            The standard name to search</span>
<span class="sd">        :return:</span>
<span class="sd">            A Button, or None if no such button exists</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">buttons_by_sname</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="o">.</span><span class="n">button</span>

    <span class="k">def</span> <span class="nf">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Property access to Button instances</span>

<span class="sd">        :param item:</span>
<span class="sd">            the sname of the button</span>
<span class="sd">        :return:</span>
<span class="sd">            the Button instance, or raise AttributeError if no such button</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">buttons_by_sname</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span>

    <span class="k">def</span> <span class="nf">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check whether a given button, referenced by sname, exists</span>

<span class="sd">        :param item:</span>
<span class="sd">            The sname of the button to search</span>
<span class="sd">        :return:</span>
<span class="sd">            True if the axis exists, false otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">buttons_by_sname</span>

<div class="viewcode-block" id="Buttons.register_button_handler"><a class="viewcode-back" href="../../api/input.html#approxeng.input.Buttons.register_button_handler">[docs]</a>    <span class="k">def</span> <span class="nf">register_button_handler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">button_handler</span><span class="p">,</span> <span class="n">buttons</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Register a handler function which will be called when a button is pressed</span>

<span class="sd">        :param button_handler:</span>
<span class="sd">            A function which will be called when any of the specified buttons are pressed. The</span>
<span class="sd">            function is called with the Button that was pressed as the sole argument.</span>
<span class="sd">        :param [Button] buttons:</span>
<span class="sd">            A list or one or more buttons which should trigger the handler when pressed. Buttons</span>
<span class="sd">            are specified as :class:`approxeng.input.Button` instances, in general controller implementations will</span>
<span class="sd">            expose these as constants such as SixAxis.BUTTON_CIRCLE. A single Button can be specified if only one button</span>
<span class="sd">            binding is required.</span>
<span class="sd">        :return:</span>
<span class="sd">            A no-arg function which can be used to remove this registration</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">buttons</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">buttons</span> <span class="o">=</span> <span class="p">[</span><span class="n">buttons</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">button</span> <span class="ow">in</span> <span class="n">buttons</span><span class="p">:</span>
            <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">buttons</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">button</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">state</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">state</span><span class="o">.</span><span class="n">button_handlers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">button_handler</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">remove</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">button_to_remove</span> <span class="ow">in</span> <span class="n">buttons</span><span class="p">:</span>
                <span class="n">state_to_remove</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">buttons</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">button_to_remove</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">state_to_remove</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">state_to_remove</span><span class="o">.</span><span class="n">button_handlers</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">button_handler</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">remove</span></div></div>
</pre></div>

           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, 2017, Tom Oinn.
      Last updated on Jul 29, 2017.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.0.7',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>