

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Usage Guide &mdash; Approximate Engineering - Input 1.0.2 documentation</title>
  

  
  
  
  

  

  
  
    
      <link rel="search" type="application/opensearchdescription+xml" title="Search within Approximate Engineering - Input 1.0.2 documentation" href="_static/opensearch.xml"/>
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Approximate Engineering - Input 1.0.2 documentation" href="index.html"/>
        <link rel="next" title="Configuring Playstation 3 Controllers" href="dualshock3.html"/>
        <link rel="prev" title="Welcome to Approximate Engineering’s Python Game Controller Documentation!" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Approximate Engineering - Input
          

          
          </a>

          
            
            
              <div class="version">
                1.0.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Usage Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#constructing-and-binding-a-controller">Constructing and Binding a Controller</a></li>
<li class="toctree-l2"><a class="reference internal" href="#standard-names">Standard Names</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#button-names">Button Names</a></li>
<li class="toctree-l3"><a class="reference internal" href="#axis-names">Axis Names</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#handling-buttons">Handling Buttons</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#querying-button-presses">Querying Button Presses</a></li>
<li class="toctree-l3"><a class="reference internal" href="#checking-for-held-buttons">Checking for Held Buttons</a></li>
<li class="toctree-l3"><a class="reference internal" href="#handling-button-presses-as-events">Handling Button Presses as Events</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#reading-and-configuring-analogue-axes">Reading and Configuring Analogue Axes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="dualshock3.html">Configuring Playstation 3 Controllers</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Documentation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Approximate Engineering - Input</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Usage Guide</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="usage-guide">
<h1>Usage Guide<a class="headerlink" href="#usage-guide" title="Permalink to this headline">¶</a></h1>
<p>This module contains general support for game controllers. It includes the top level classes such as buttons and
joystick axes which are used for any kind of controller, particular controllers and binding mechanisms are implemented
in sub-modules. The key classes shared across all controllers are:</p>
<ul class="simple">
<li><a class="reference internal" href="api/input.html#approxeng.input.CentredAxis" title="approxeng.input.CentredAxis"><code class="xref py py-class docutils literal"><span class="pre">approxeng.input.CentredAxis</span></code></a> <a class="reference internal" href="api/input.html#approxeng.input.TriggerAxis" title="approxeng.input.TriggerAxis"><code class="xref py py-class docutils literal"><span class="pre">approxeng.input.TriggerAxis</span></code></a> and <a class="reference internal" href="api/input.html#approxeng.input.BinaryAxis" title="approxeng.input.BinaryAxis"><code class="xref py py-class docutils literal"><span class="pre">approxeng.input.BinaryAxis</span></code></a>
represent different kinds of axis of an analogue control. The centred axis is used for joysticks with a negative value
at one end of the range and positive at the other, whereas the trigger axis is used for axes with zero at the resting
position and increasingly positive values as the control is pressed. As the names suggest, these are used for centred
and trigger controls respectively - a PS3 joystick consists of two centred axes, an XBox One front trigger consists of
a single trigger axis. The BinaryAxis is used for controllers which export buttons as axes (both the PS4 and the XBox
controller D-pads are actually a pair of axes in terms of implementation, although they don&#8217;t have any analogue
control, they just emit either -1, 0 or 1)</li>
<li><a class="reference internal" href="api/input.html#approxeng.input.Button" title="approxeng.input.Button"><code class="xref py py-class docutils literal"><span class="pre">approxeng.input.Button</span></code></a> represents a single button. As with the Axis class you don&#8217;t create these, instead you
need to use the instances provided by the driver classes.</li>
<li><a class="reference internal" href="api/input.html#approxeng.input.Buttons" title="approxeng.input.Buttons"><code class="xref py py-class docutils literal"><span class="pre">approxeng.input.Buttons</span></code></a> represents the state of all the buttons on the controller. You&#8217;ll use the provided
instance of this class to register button handlers, ask whether any buttons were pressed, and get information about
how long a button has been held down.</li>
<li>Finally, all controller classes inherit from <a class="reference internal" href="api/input.html#approxeng.input.Controller" title="approxeng.input.Controller"><code class="xref py py-class docutils literal"><span class="pre">approxeng.input.Controller</span></code></a>. This provides a
<a class="reference internal" href="api/input.html#approxeng.input.Buttons" title="approxeng.input.Buttons"><code class="xref py py-class docutils literal"><span class="pre">approxeng.input.Buttons</span></code></a> instance called &#8216;buttons&#8217;, and an <a class="reference internal" href="api/input.html#approxeng.input.Axes" title="approxeng.input.Axes"><code class="xref py py-class docutils literal"><span class="pre">approxeng.input.Axes</span></code></a> instance called
&#8216;axes&#8217;. These will come in handy later!</li>
</ul>
<div class="section" id="constructing-and-binding-a-controller">
<h2>Constructing and Binding a Controller<a class="headerlink" href="#constructing-and-binding-a-controller" title="Permalink to this headline">¶</a></h2>
<p>Once your controller is physically connected to the computer (whether by USB, bluetooth or magic) and you have a
corresponding entry in the dev filesystem, you need to create an object to receive and interpret events from the
hardware, and you need to set up a mechanism by which events will be sent to that object. The object in this case will
be a subclass of <a class="reference internal" href="api/input.html#approxeng.input.Controller" title="approxeng.input.Controller"><code class="xref py py-class docutils literal"><span class="pre">approxeng.input.Controller</span></code></a>, currently there are three implementations:</p>
<ul class="simple">
<li><a class="reference internal" href="api/dualshock3.html#approxeng.input.dualshock3.DualShock3" title="approxeng.input.dualshock3.DualShock3"><code class="xref py py-class docutils literal"><span class="pre">approxeng.input.dualshock3.DualShock3</span></code></a> handles PS3 controllers</li>
<li><a class="reference internal" href="api/dualshock4.html#approxeng.input.dualshock4.DualShock4" title="approxeng.input.dualshock4.DualShock4"><code class="xref py py-class docutils literal"><span class="pre">approxeng.input.dualshock4.DualShock4</span></code></a> is for PS4 controllers</li>
<li><a class="reference internal" href="api/xboxone.html#approxeng.input.xboxone.WiredXBoxOneSPad" title="approxeng.input.xboxone.WiredXBoxOneSPad"><code class="xref py py-class docutils literal"><span class="pre">approxeng.input.xboxone.WiredXBoxOneSPad</span></code></a> and <a class="reference internal" href="api/xboxone.html#approxeng.input.xboxone.WirelessXBoxOneSPad" title="approxeng.input.xboxone.WirelessXBoxOneSPad"><code class="xref py py-class docutils literal"><span class="pre">approxeng.input.xboxone.WirelessXBoxOneSPad</span></code></a> are for the
newer XBox One controllers. For whatever reason this controller reports different axes and buttons when connected over
bluetooth to when it&#8217;s connected with a wire, so you&#8217;ll need to use the correct one!</li>
<li><a class="reference internal" href="api/rockcandy.html#approxeng.input.rockcandy.RockCandy" title="approxeng.input.rockcandy.RockCandy"><code class="xref py py-class docutils literal"><span class="pre">approxeng.input.rockcandy.RockCandy</span></code></a> for the Rock Candy PS4 controller clone (it appears to describe itself as
a PS3 controller, but has the controls of a PS4 one!). Contribution from Keith Ellis (<a class="reference external" href="https://twitter.com/pitutorials">pitutorials</a> on twitter).</li>
</ul>
<p>In general you will not explicitly create these objects yourself, instead you can use the binding layer to discover a
connected controller (optionally supplying a particular kind of controller you want, otherwise it just finds the first
one it can). This will create the controller object from which you can read things like axis values, and also set up the
necessary logic to pull events out of the evdev linux system and update the values without you having to do anything.</p>
<p>The details of the binding process are described at <a class="reference internal" href="api/selectbinder.html#binding-reference-label"><span class="std std-ref">Binding - approxeng.input.selectbinder</span></a>.</p>
</div>
<div class="section" id="standard-names">
<h2>Standard Names<a class="headerlink" href="#standard-names" title="Permalink to this headline">¶</a></h2>
<p>All the controllers supported by this library are fairly similar - they have two analogue joysticks, a bunch of buttons,
some triggers etc. It would be helpful therefore to be able to make use of one controller type but make it as easy as
possible to use others without substantial code changes in your own code.</p>
<p>To do this the library assigns a standard name, or &#8216;sname&#8217; to each button and axis on every controller. These are based
loosely on the buttons found on a PS3 controller, at the cost of minor confusion for the XBox users (where, for example,
the &#8216;X&#8217; button is referred to by the name &#8216;square&#8217;). As long as you use controls which are common to all three
controllers you should be able to transparently make use of whichever of them is available at the time. You can also
choose to make use of facilities which are only available on specific hardware (such as the analogue triggers on the PS4
and XBoxOne controllers) but you should bear in mind that this will preclude use of a less well equipped controller. Up
to you.</p>
<p>A look at the source for each of the controller subclasses should make it obvious what names are available, but the
standard ones are as follows:</p>
<div class="section" id="button-names">
<h3>Button Names<a class="headerlink" href="#button-names" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="24%" />
<col width="28%" />
<col width="24%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Standard name</td>
<td>PS3</td>
<td>PS4 / RockCandy</td>
<td>XBoxOne</td>
</tr>
<tr class="row-even"><td>square</td>
<td>Square</td>
<td>Square</td>
<td>X</td>
</tr>
<tr class="row-odd"><td>triangle</td>
<td>Triangle</td>
<td>Triangle</td>
<td>Y</td>
</tr>
<tr class="row-even"><td>circle</td>
<td>Circle</td>
<td>Circle</td>
<td>B</td>
</tr>
<tr class="row-odd"><td>cross</td>
<td>Cross</td>
<td>Cross</td>
<td>A</td>
</tr>
<tr class="row-even"><td>ls</td>
<td>Left Stick</td>
<td>Left Stick</td>
<td>Left Stick</td>
</tr>
<tr class="row-odd"><td>rs</td>
<td>Right Stick</td>
<td>Right Stick</td>
<td>Right Stick</td>
</tr>
<tr class="row-even"><td>select</td>
<td>Select</td>
<td>Share</td>
<td>View</td>
</tr>
<tr class="row-odd"><td>start</td>
<td>Start</td>
<td>Options</td>
<td>Menu</td>
</tr>
<tr class="row-even"><td>home</td>
<td>PS</td>
<td>PS</td>
<td>XBox</td>
</tr>
<tr class="row-odd"><td>dleft</td>
<td>DPad Left</td>
<td>DPad Left</td>
<td>DPad Left</td>
</tr>
<tr class="row-even"><td>dup</td>
<td>DPad Up</td>
<td>DPad Up</td>
<td>DPad Up</td>
</tr>
<tr class="row-odd"><td>dright</td>
<td>DPad Right</td>
<td>DPad Right</td>
<td>DPad Right</td>
</tr>
<tr class="row-even"><td>ddown</td>
<td>DPad Down</td>
<td>DPad Down</td>
<td>Dpad Down</td>
</tr>
<tr class="row-odd"><td>l1</td>
<td>L1 Trigger</td>
<td>L1 Trigger</td>
<td>LB Trigger</td>
</tr>
<tr class="row-even"><td>l2</td>
<td>L2 Trigger</td>
<td>L2 Trigger</td>
<td>&#8212;</td>
</tr>
<tr class="row-odd"><td>r1</td>
<td>R1 Trigger</td>
<td>R1 Trigger</td>
<td>RB Trigger</td>
</tr>
<tr class="row-even"><td>r2</td>
<td>R2 Trigger</td>
<td>R2 Trigger</td>
<td>&#8212;</td>
</tr>
<tr class="row-odd"><td>ps4_pad</td>
<td>&#8212;</td>
<td>Trackpad</td>
<td>&#8212;</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The lack of l2 and r2 for the XBoxOne controller is because these buttons don&#8217;t appear as buttons in the event
stream. This is actually a fairly easy fix but in the current code you can&#8217;t access them as buttons.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The DualShock4 trackpad only works as a single button. It doesn&#8217;t have an equivalent on the other controllers so
only use if you&#8217;re happy to be locked into this particular hardware.</p>
</div>
</div>
<div class="section" id="axis-names">
<h3>Axis Names<a class="headerlink" href="#axis-names" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="24%" />
<col width="28%" />
<col width="24%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Standard name</td>
<td>PS3</td>
<td>PS4 / RockCandy</td>
<td>XBoxOne</td>
</tr>
<tr class="row-even"><td>lx</td>
<td>Left X</td>
<td>Left X</td>
<td>Left X</td>
</tr>
<tr class="row-odd"><td>ly</td>
<td>Left Y</td>
<td>Left Y</td>
<td>Left Y</td>
</tr>
<tr class="row-even"><td>rx</td>
<td>Right X</td>
<td>Right X</td>
<td>Right X</td>
</tr>
<tr class="row-odd"><td>ry</td>
<td>Right Y</td>
<td>Right Y</td>
<td>Right Y</td>
</tr>
<tr class="row-even"><td>lt</td>
<td>&#8212;</td>
<td>L2 Trigger</td>
<td>LT Trigger</td>
</tr>
<tr class="row-odd"><td>rt</td>
<td>&#8212;</td>
<td>R2 Trigger</td>
<td>RT Trigger</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The triggers on the DualShock3 can&#8217;t be used as analogue axes, only use lt and rt if you&#8217;re happy you won&#8217;t need to
use a PS3 controller in your project.</p>
</div>
</div>
</div>
<div class="section" id="handling-buttons">
<h2>Handling Buttons<a class="headerlink" href="#handling-buttons" title="Permalink to this headline">¶</a></h2>
<p>There are two styles of button handler. The simplest, and the one you&#8217;re likely to use in almost all cases, is a polling
mechanism - you can ask the Controller object what buttons have been pressed since you last asked that question. This
is easy to use, you don&#8217;t have to worry you&#8217;ll miss a button press because you were off doing something else, and it
uses the standard name system. At its simplest you get back an array of standard names of buttons which were pressed
since last time. This part of the API also allows you to test for held buttons, including the duration for which the
button has been held. Handy for where you want the magnitude of a response to be determined by how long a button is held
(could be useful for simulating a &#8216;power charge&#8217; or similar).</p>
<p>The second kind is to register a callback function which should be called when a button is pressed. In general you no
longer need to do this - it was used primarily for cases where e.g. a button should interrupt whatever was going on with
a robot and bounce the system back to some safe state, but there are better ways to do this. Nonetheless, this mechanism
is still present and you can use it if you really need to.</p>
<div class="section" id="querying-button-presses">
<h3>Querying Button Presses<a class="headerlink" href="#querying-button-presses" title="Permalink to this headline">¶</a></h3>
<p>The most common requirement you&#8217;ll have will be to find out whether the user pressed a button. This sounds obvious, but
in fact it&#8217;s slightly more subtle - what you really want to know is whether the user pressed a button at any point since
you last asked this question! That way, even if you don&#8217;t ask very often you won&#8217;t miss button presses and you don&#8217;t
have to worry about the user pressing so fast you can&#8217;t detect it.</p>
<p>You can do this with the get_and_clear_button_press_history function. The <a class="reference internal" href="api/input.html#approxeng.input.Buttons" title="approxeng.input.Buttons"><code class="xref py py-class docutils literal"><span class="pre">approxeng.input.Buttons</span></code></a> instance
tracks whether buttons were pressed since the last call to this function and returns a
<a class="reference internal" href="api/input.html#approxeng.input.ButtonPresses" title="approxeng.input.ButtonPresses"><code class="xref py py-class docutils literal"><span class="pre">approxeng.input.ButtonPresses</span></code></a> with the pressed buttons:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">approxeng.input.dualshock3</span> <span class="kn">import</span> <span class="n">DualShock3</span>
<span class="kn">from</span> <span class="nn">approxeng.input.selectbinder</span> <span class="kn">import</span> <span class="n">ControllerResource</span>

<span class="c1"># Get a joystick</span>
<span class="k">with</span> <span class="n">ControllerResource</span><span class="p">(</span><span class="n">controller_class</span> <span class="o">=</span> <span class="n">DualShock3</span><span class="p">)</span> <span class="k">as</span> <span class="n">joystick</span><span class="p">:</span>
    <span class="c1"># Loop forever</span>
    <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># This is an instance of approxeng.input.ButtonPresses</span>
        <span class="n">presses</span> <span class="o">=</span> <span class="n">joystick</span><span class="o">.</span><span class="n">buttons</span><span class="o">.</span><span class="n">get_and_clear_button_press_history</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">presses</span><span class="o">.</span><span class="n">was_pressed</span><span class="p">(</span><span class="s1">&#39;square&#39;</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;SQUARE pressed since last check&#39;</span><span class="p">)</span>

        <span class="c1"># If we had any presses, print the list of pressed buttons by standard name</span>
        <span class="k">if</span> <span class="n">presses</span><span class="o">.</span><span class="n">has_presses</span><span class="p">():</span>
            <span class="k">print</span><span class="p">(</span><span class="n">presses</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="checking-for-held-buttons">
<h3>Checking for Held Buttons<a class="headerlink" href="#checking-for-held-buttons" title="Permalink to this headline">¶</a></h3>
<p>You can also check whether a button is currently held, and, if so, how long it&#8217;s been held for to date:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">approxeng.input.dualshock3</span> <span class="kn">import</span> <span class="n">DualShock3</span>
<span class="kn">from</span> <span class="nn">approxeng.input.selectbinder</span> <span class="kn">import</span> <span class="n">ControllerResource</span>

<span class="c1"># Get a joystick</span>
<span class="k">with</span> <span class="n">ControllerResource</span><span class="p">(</span><span class="n">controller_class</span> <span class="o">=</span> <span class="n">DualShock3</span><span class="p">)</span> <span class="k">as</span> <span class="n">joystick</span><span class="p">:</span>
    <span class="c1"># Loop forever</span>
    <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># Use is_held_name to refer to a button by name, the old form &#39;is_held&#39; needs you to</span>
        <span class="c1"># have the Button instance</span>
        <span class="n">held</span> <span class="o">=</span> <span class="n">joystick</span><span class="o">.</span><span class="n">buttons</span><span class="o">.</span><span class="n">is_held_name</span><span class="p">(</span><span class="s1">&#39;circle&#39;</span><span class="p">)</span>
        <span class="c1"># If the button isn&#39;t held at the moment this will be None</span>
        <span class="k">if</span> <span class="n">held</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="c1"># If the button was held, this is the number of seconds since it was initially pressed</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Circle held for {} seconds&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">held</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="handling-button-presses-as-events">
<h3>Handling Button Presses as Events<a class="headerlink" href="#handling-button-presses-as-events" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">approxeng.input.selectbinder</span> <span class="kn">import</span> <span class="n">ControllerResource</span>
<span class="kn">from</span> <span class="nn">approxeng.input.dualshock3</span> <span class="kn">import</span> <span class="n">DualShock3</span>
<span class="c1"># Get a joystick</span>
<span class="k">with</span> <span class="n">ControllerResource</span><span class="p">(</span><span class="n">controller_class</span> <span class="o">=</span> <span class="n">DualShock3</span><span class="p">)</span> <span class="k">as</span> <span class="n">joystick</span><span class="p">:</span>
    <span class="c1"># Create a handler function</span>
    <span class="k">def</span> <span class="nf">button_handler</span><span class="p">(</span><span class="n">button</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Button clicked {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">button</span><span class="p">))</span>
    <span class="c1"># Register the handler to the SQUARE button</span>
    <span class="n">joystick</span><span class="o">.</span><span class="n">buttons</span><span class="o">.</span><span class="n">register_button_handler</span><span class="p">(</span><span class="n">button_handler</span><span class="p">,</span> <span class="n">joystick</span><span class="o">.</span><span class="n">buttons</span><span class="o">.</span><span class="n">for_name</span><span class="p">(</span><span class="s1">&#39;square&#39;</span><span class="p">))</span>
    <span class="c1"># We can also register a handler to multiple buttons in one call</span>
    <span class="n">joystick</span><span class="o">.</span><span class="n">buttons</span><span class="o">.</span><span class="n">register_button_handler</span><span class="p">(</span><span class="n">button_handler</span><span class="p">,</span> <span class="p">[</span><span class="n">joystick</span><span class="o">.</span><span class="n">buttons</span><span class="o">.</span><span class="n">for_name</span><span class="p">(</span><span class="s1">&#39;circle&#39;</span><span class="p">),</span>
                                                              <span class="n">joystick</span><span class="o">.</span><span class="n">buttons</span><span class="o">.</span><span class="n">for_name</span><span class="p">(</span><span class="s1">&#39;triangle&#39;</span><span class="p">)])</span>
    <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># Do stuff here, only register the button handlers once, not in this loop!</span>
        <span class="c1"># If the buttons are pressed, your handlers will be called but not from this thread.</span>
        <span class="k">pass</span>
</pre></div>
</div>
<p>Registering a button handler, a function which is called whenever the button is pressed, can be useful when you don&#8217;t
want to repeatedly check whether something&#8217;s been pressed. I used event handlers in Triangula&#8217;s code to jump the robot
back to her main menu any time I pressed the home button on the controller. Because I used an event to do this, I didn&#8217;t
need to worry about getting into some kind of locked state where the robot was out of control and I couldn&#8217;t stop her -
the button always did the same thing.</p>
<p>The register_button_handler function actually returns a function which can be called to de-register the handler, you
should do this to stop your handler being called when it&#8217;s no longer needed.</p>
<p>As you can see, there&#8217;s quite a lot of thinking required to make button handlers work properly. They may be the right
way to do things (for example, you might want a handler which reset the centre point of the analogue sticks, this would
be best done as a handler because it could be called at any time from anywhere else in your code and you wouldn&#8217;t have
to worry about it). If, however, you&#8217;re in a polling loop such as Triangula&#8217;s task framework or PyGame&#8217;s event loop you
probably just want to know whether a button was pressed since you last checked.</p>
</div>
</div>
<div class="section" id="reading-and-configuring-analogue-axes">
<h2>Reading and Configuring Analogue Axes<a class="headerlink" href="#reading-and-configuring-analogue-axes" title="Permalink to this headline">¶</a></h2>
<p>Analogue axes on the controller are those which can vary continuously over their range. Typically these are joysticks
and triggers. This code maps all axes either to a range from -1.0 to 1.0 (for centred axes such as joysticks) or from
0.0 to 1.0 (for things like triggers where the resting point is at one end of the range of movement). Joysticks are
modelled as two independent centred axes, one for the horizontal part and one for the vertical.</p>
<p>We could just read out the value supplied by the controller hardware and provide that value, but there are a few things
we might want to do first, and which the code provides:</p>
<ul class="simple">
<li>The centre point of the hardware is often not the numeric centre of the range. This is because hardware exists in the
real world, where things can be slightly messy. It&#8217;s generally not far off, but often the resting position isn&#8217;t at
0.0.</li>
<li>The theoretical range of the controller is often larger than the actual range produced. For example, we might have a
controller which claims to produce values from -255 to 255 (before we normalise down to -1.0 to 1.0) but which
actually only ever produces values between, say, -251 and 243.</li>
<li>It&#8217;s often desirable to have a dead zone near the resting position, so only intentional movements of the controller
are detected as motion. Analogue controls often have a bit of noise - the joystick may rest at 0 in theory, but in
practice we might see a string of values such as -1, -1, 0, 1, 1, 0, 0 etc etc.</li>
<li>Similarly, we might want a &#8216;hot zone&#8217; near the extreme positions of the axis, where any higher magnitude values should
be interpreted as the maximum value. This means we&#8217;re able to get to the highest value without having to worry about
controller noise.</li>
</ul>
<p>Different controllers report different ranges (for example, the PS3 controller range is from 0 to 255 whereas the XBox
controller is from -32768 to 32768 when plugged in and, for some ungodly reason, 0 to 65335 when wireless), but you
don&#8217;t have to worry about this as the controller implementations specify this internally and you&#8217;ll only ever see values
between -1.0 and 1.0, or between 0.0 and 1.0 for trigger axes.</p>
<p>The <a class="reference internal" href="api/input.html#approxeng.input.CentredAxis" title="approxeng.input.CentredAxis"><code class="xref py py-class docutils literal"><span class="pre">approxeng.input.CentredAxis</span></code></a> and <a class="reference internal" href="api/input.html#approxeng.input.TriggerAxis" title="approxeng.input.TriggerAxis"><code class="xref py py-class docutils literal"><span class="pre">approxeng.input.TriggerAxis</span></code></a> both auto-range, in that they start
off with a maximum and minimum value that&#8217;s well within the theoretical range, and expand this out when they see higher
values from the controller. This means we don&#8217;t have to worry that the theoretical range of the controller isn&#8217;t fully
used, we&#8217;ll always have our -1.0 to 1.0 correspond to the actual controller movement.</p>
<p>Auto-centring isn&#8217;t possible as we can&#8217;t know whether the user is touching the controller, but you can set the centre
point for an individual <a class="reference internal" href="api/input.html#approxeng.input.CentredAxis" title="approxeng.input.CentredAxis"><code class="xref py py-class docutils literal"><span class="pre">approxeng.input.CentredAxis</span></code></a> by setting its &#8216;centre&#8217; property, or for a complete set
defined by an <code class="xref py py-class docutils literal"><span class="pre">approxent.input.Axes</span></code> object by calling the set_axis_centres() function on the Axes object. This
function takes an arbitrary number of parameters and ignores all of them - this is done so you can specify the function
as a button handler.</p>
<p>Dead zones and hot zones are defined as a proportion of the range of the axis:</p>
<ul class="simple">
<li>For a trigger axis the dead zone is from the 0.0 raw position of the controller up to the specified value, and the hot
zone is from 1.0 - the value to 1.0. Values below the dead zone value will be returned as 0.0, and values above the
hot zone will be returned as 1.0, with values inbetween scaling from 0.0 at the edge of the dead zone to 1.0 at the
edge of the hot zone.</li>
<li>For centred axes the same applies, but with the dead zone and hot zone values specifying the proportion of each half
(positive and negative) of the range. So, if the dead zone is set to 0.1 and hot zone to 0.2, positive raw values
above 0.8 will return a corrected value of 1.0, and those below 0.1 will return 0.0. For negative values the same
applies, except that values below -0.8 will return -1.0 and those above -0.1 will return 0.0</li>
</ul>
<p>To obtain the corrected values for an axis you need to call the corrected_value() function on the axis object.</p>
<p>As an example, the PS3 controller exposes four axes, two for each analogue stick. The following code will get a
controller, and will run around in a loop printing the corrected value of the left analogue stick:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">approxeng.input.dualshock3</span> <span class="kn">import</span> <span class="n">DualShock3</span>
<span class="kn">from</span> <span class="nn">approxeng.input.selectbinder</span> <span class="kn">import</span> <span class="n">ControllerResource</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">sleep</span>

<span class="c1"># We can pass any additional keyword arguments here, they&#39;ll be passed on to the controller class constructor.</span>
<span class="c1"># All controller subclasses understand dead_zone and hot_zone, specific controller types may accept other args.</span>
<span class="k">with</span> <span class="n">ControllerResource</span><span class="p">(</span><span class="n">controller_class</span> <span class="o">=</span> <span class="n">DualShock3</span><span class="p">,</span> <span class="n">dead_zone</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">hot_zone</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span> <span class="k">as</span> <span class="n">joystick</span><span class="p">:</span>
    <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># Loop, printing the corrected value from the left stick</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">joystick</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="s1">&#39;lx&#39;</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">joystick</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="s1">&#39;ly&#39;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Left stick: x={}, y={}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">))</span>
        <span class="c1"># Don&#39;t be too spammy!</span>
        <span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="dualshock3.html" class="btn btn-neutral float-right" title="Configuring Playstation 3 Controllers" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Welcome to Approximate Engineering’s Python Game Controller Documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Tom Oinn.
      Last updated on Apr 11, 2017.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0.2',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>