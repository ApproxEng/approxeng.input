

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>CamJam Edukit 3 Robot &mdash; Approximate Engineering - Input 2.2.0 documentation</title>
  

  
  
  
  

  

  
  
    
      <link rel="search" type="application/opensearchdescription+xml"
            title="Search within Approximate Engineering - Input 2.2.0 documentation"
            href="../_static/opensearch.xml"/>
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Controller Failover" href="failover.html" />
    <link rel="prev" title="Examples" href="../examples.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Approximate Engineering - Input
          

          
          </a>

          
            
            
              <div class="version">
                2.2.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="../simpleusage.html">Simple Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../simpleusage.html#standard-names">Standard Names</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bluetooth.html">Pairing Controllers over Bluetooth</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../addingcontrollers.html">Adding support for a new controller type</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../examples.html">Examples</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">CamJam Edukit 3 Robot</a></li>
<li class="toctree-l2"><a class="reference internal" href="failover.html">Controller Failover</a></li>
<li class="toctree-l2"><a class="reference internal" href="show_controls.html">Showing Controller Properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="streams.html">Streaming Axis and Button Hold values</a></li>
<li class="toctree-l2"><a class="reference internal" href="tiny4wd.html">Tiny4WD Robot Drive</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../howtouse.html">Advanced Usage Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sys.html">LEDs and Battery Monitoring</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Approximate Engineering - Input</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../examples.html">Examples</a> &raquo;</li>
        
      <li>CamJam Edukit 3 Robot</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="camjam-edukit-3-robot">
<span id="example-camjam"></span><h1>CamJam Edukit 3 Robot<a class="headerlink" href="#camjam-edukit-3-robot" title="Permalink to this headline">¶</a></h1>
<p>This example drives the <a class="reference external" href="https://camjam.me/?page_id=1035">CamJam EduKit 3</a> robot and is based on
<a class="reference internal" href="tiny4wd.html#example-tiny4wd"><span class="std std-ref">Tiny4WD Robot Drive</span></a> with some modifications by Mike Horne to support the different motor driver board that kit uses.</p>
<p>The code below shows, with a few extra bits and pieces needed in case you’re running without the robot libraries, how to
use this library to drive it around. The left analogue stick controls the robot, and the HOME button exits.</p>
<img alt="../_images/edukit3.jpg" src="../_images/edukit3.jpg" />
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># Code for CamJam EduKit 3 robot</span>
<span class="c1">#</span>
<span class="c1"># By Mike Horne, based on code by Tom Oinn/Emma Norling code</span>

<span class="c1"># Need floating point division of integers</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span>

<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">sleep</span>

<span class="k">try</span><span class="p">:</span>
    <span class="c1"># Attempt to import the GPIO Zero library. If this fails, because we&#39;re running somewhere</span>
    <span class="c1"># that doesn&#39;t have the library, we create dummy functions for set_speeds and stop_motors which</span>
    <span class="c1"># just print out what they&#39;d have done. This is a fairly common way to deal with hardware that</span>
    <span class="c1"># may or may not exist!</span>

    <span class="c1"># Use GPIO Zero implementation of CamJam EduKit robot (thanks Ben Nuttall/Dave Jones!)</span>
    <span class="kn">from</span> <span class="nn">gpiozero</span> <span class="kn">import</span> <span class="n">CamJamKitRobot</span>

    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;GPIO Zero found&#39;</span><span class="p">)</span>

    <span class="c1"># Get the robot instance and the independent motor controllers</span>
    <span class="n">robot</span> <span class="o">=</span> <span class="n">CamJamKitRobot</span><span class="p">()</span>
    <span class="n">motor_left</span> <span class="o">=</span> <span class="n">robot</span><span class="o">.</span><span class="n">left_motor</span>
    <span class="n">motor_right</span> <span class="o">=</span> <span class="n">robot</span><span class="o">.</span><span class="n">right_motor</span>

    <span class="c1"># Motors are reversed. If you find your robot going backwards, set this to 1</span>
    <span class="n">motor_multiplier</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>


    <span class="k">def</span> <span class="nf">set_speeds</span><span class="p">(</span><span class="n">power_left</span><span class="p">,</span> <span class="n">power_right</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        As we have an motor hat, we can use the motors</span>

<span class="sd">        :param power_left: </span>
<span class="sd">            Power to send to left motor</span>
<span class="sd">        :param power_right: </span>
<span class="sd">            Power to send to right motor, will be inverted to reflect chassis layout</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># If one wants to see the &#39;raw&#39; 0-100 values coming in</span>
        <span class="c1"># print(&quot;source left: {}&quot;.format(power_left))</span>
        <span class="c1"># print(&quot;source right: {}&quot;.format(power_right))</span>

        <span class="c1"># Take the 0-100 inputs down to 0-1 and reverse them if necessary</span>
        <span class="n">power_left</span> <span class="o">=</span> <span class="p">(</span><span class="n">motor_multiplier</span> <span class="o">*</span> <span class="n">power_left</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
        <span class="n">power_right</span> <span class="o">=</span> <span class="p">(</span><span class="n">motor_multiplier</span> <span class="o">*</span> <span class="n">power_right</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>

        <span class="c1"># Print the converted values out for debug</span>
        <span class="c1"># print(&quot;left: {}&quot;.format(power_left))</span>
        <span class="c1"># print(&quot;right: {}&quot;.format(power_right))</span>

        <span class="c1"># If power is less than 0, we want to turn the motor backwards, otherwise turn it forwards</span>
        <span class="k">if</span> <span class="n">power_left</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">motor_left</span><span class="o">.</span><span class="n">backward</span><span class="p">(</span><span class="o">-</span><span class="n">power_left</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">motor_left</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">power_left</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">power_right</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">motor_right</span><span class="o">.</span><span class="n">backward</span><span class="p">(</span><span class="o">-</span><span class="n">power_right</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">motor_right</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">power_right</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">stop_motors</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        As we have an motor hat, stop the motors using their motors call</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Turn both motors off</span>
        <span class="n">motor_left</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="n">motor_right</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>

<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>

    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;GPIO Zero not found, using dummy functions.&#39;</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">set_speeds</span><span class="p">(</span><span class="n">power_left</span><span class="p">,</span> <span class="n">power_right</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        No motor hat - print what we would have sent to it if we&#39;d had one.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;DEBUG Left: {}, Right: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">power_left</span><span class="p">,</span> <span class="n">power_right</span><span class="p">))</span>
        <span class="n">sleep</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">stop_motors</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        No motor hat, so just print a message.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;DEBUG Motors stopping&#39;</span><span class="p">)</span>

<span class="c1"># All we need, as we don&#39;t care which controller we bind to, is the ControllerResource</span>
<span class="kn">from</span> <span class="nn">approxeng.input.selectbinder</span> <span class="kn">import</span> <span class="n">ControllerResource</span>


<span class="c1"># Enable logging of debug messages, by default these aren&#39;t shown</span>
<span class="c1"># import logzero</span>
<span class="c1"># logzero.setup_logger(name=&#39;approxeng.input&#39;, level=logzero.logging.DEBUG)</span>

<span class="k">class</span> <span class="nc">RobotStopException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The simplest possible subclass of Exception, we&#39;ll raise this if we want to stop the robot</span>
<span class="sd">    for any reason. Creating a custom exception like this makes the code more readable later.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>


<span class="k">def</span> <span class="nf">mixer</span><span class="p">(</span><span class="n">yaw</span><span class="p">,</span> <span class="n">throttle</span><span class="p">,</span> <span class="n">max_power</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Mix a pair of joystick axes, returning a pair of wheel speeds. This is where the mapping from</span>
<span class="sd">    joystick positions to wheel powers is defined, so any changes to how the robot drives should</span>
<span class="sd">    be made here, everything else is really just plumbing.</span>
<span class="sd">    </span>
<span class="sd">    :param yaw: </span>
<span class="sd">        Yaw axis value, ranges from -1.0 to 1.0</span>
<span class="sd">    :param throttle: </span>
<span class="sd">        Throttle axis value, ranges from -1.0 to 1.0</span>
<span class="sd">    :param max_power: </span>
<span class="sd">        Maximum speed that should be returned from the mixer, defaults to 100</span>
<span class="sd">    :return: </span>
<span class="sd">        A pair of power_left, power_right integer values to send to the motor driver</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">left</span> <span class="o">=</span> <span class="n">throttle</span> <span class="o">+</span> <span class="n">yaw</span>
    <span class="n">right</span> <span class="o">=</span> <span class="n">throttle</span> <span class="o">-</span> <span class="n">yaw</span>
    <span class="n">scale</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">max_power</span><span class="p">)</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">left</span><span class="p">),</span> <span class="nb">abs</span><span class="p">(</span><span class="n">right</span><span class="p">))</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">left</span> <span class="o">*</span> <span class="n">scale</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">right</span> <span class="o">*</span> <span class="n">scale</span><span class="p">)</span>


<span class="c1"># Outer try / except catches the RobotStopException we just defined, which we&#39;ll raise when we want to</span>
<span class="c1"># bail out of the loop cleanly, shutting the motors down. We can raise this in response to a button press</span>
<span class="k">try</span><span class="p">:</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="c1"># Inner try / except is used to wait for a controller to become available, at which point we</span>
        <span class="c1"># bind to it and enter a loop where we read axis values and send commands to the motors.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Bind to any available joystick, this will use whatever&#39;s connected as long as the library</span>
            <span class="c1"># supports it.</span>
            <span class="k">with</span> <span class="n">ControllerResource</span><span class="p">(</span><span class="n">dead_zone</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">hot_zone</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span> <span class="k">as</span> <span class="n">joystick</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Controller found, press HOME button to exit, use left stick to drive.&#39;</span><span class="p">)</span>
                <span class="k">print</span><span class="p">(</span><span class="n">joystick</span><span class="o">.</span><span class="n">controls</span><span class="p">)</span>
                <span class="c1"># Loop until the joystick disconnects, or we deliberately stop by raising a</span>
                <span class="c1"># RobotStopException</span>
                <span class="k">while</span> <span class="n">joystick</span><span class="o">.</span><span class="n">connected</span><span class="p">:</span>
                    <span class="c1"># Get joystick values from the left analogue stick</span>
                    <span class="n">x_axis</span><span class="p">,</span> <span class="n">y_axis</span> <span class="o">=</span> <span class="n">joystick</span><span class="p">[</span><span class="s1">&#39;lx&#39;</span><span class="p">,</span> <span class="s1">&#39;ly&#39;</span><span class="p">]</span>
                    <span class="c1"># Get power from mixer function</span>
                    <span class="n">power_left</span><span class="p">,</span> <span class="n">power_right</span> <span class="o">=</span> <span class="n">mixer</span><span class="p">(</span><span class="n">yaw</span><span class="o">=</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">throttle</span><span class="o">=</span><span class="n">y_axis</span><span class="p">)</span>
                    <span class="c1"># Set motor speeds</span>
                    <span class="n">set_speeds</span><span class="p">(</span><span class="n">power_left</span><span class="p">,</span> <span class="n">power_right</span><span class="p">)</span>
                    <span class="c1"># Get a ButtonPresses object containing everything that was pressed since the last</span>
                    <span class="c1"># time around this loop.</span>
                    <span class="n">joystick</span><span class="o">.</span><span class="n">check_presses</span><span class="p">()</span>
                    <span class="c1"># Print out any buttons that were pressed, if we had any</span>
                    <span class="k">if</span> <span class="n">joystick</span><span class="o">.</span><span class="n">has_presses</span><span class="p">:</span>
                        <span class="k">print</span><span class="p">(</span><span class="n">joystick</span><span class="o">.</span><span class="n">presses</span><span class="p">)</span>
                    <span class="c1"># If home was pressed, raise a RobotStopException to bail out of the loop</span>
                    <span class="c1"># Home is generally the PS button for playstation controllers, XBox for XBox etc</span>
                    <span class="k">if</span> <span class="s1">&#39;home&#39;</span> <span class="ow">in</span> <span class="n">joystick</span><span class="o">.</span><span class="n">presses</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="n">RobotStopException</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
            <span class="c1"># We get an IOError when using the ControllerResource if we don&#39;t have a controller yet,</span>
            <span class="c1"># so in this case we just wait a second and try again after printing a message.</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;No controller found yet&#39;</span><span class="p">)</span>
            <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="n">RobotStopException</span><span class="p">:</span>
    <span class="c1"># This exception will be raised when the home button is pressed, at which point we should</span>
    <span class="c1"># stop the motors.</span>
    <span class="n">stop_motors</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="failover.html" class="btn btn-neutral float-right" title="Controller Failover" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../examples.html" class="btn btn-neutral" title="Examples" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Tom Oinn
      Last updated on Feb 11, 2019.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>