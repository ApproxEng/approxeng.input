

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Binding - approxeng.input.selectbinder &mdash; Approximate Engineering - Input 2.2.0 documentation</title>
  

  
  
  
  

  

  
  
    
      <link rel="search" type="application/opensearchdescription+xml" title="Search within Approximate Engineering - Input 2.2.0 documentation" href="../_static/opensearch.xml"/>
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Approximate Engineering - Input 2.2.0 documentation" href="../index.html"/>
        <link rel="up" title="API Documentation" href="../api.html"/>
        <link rel="next" title="PlayStation 3 Controller Support" href="dualshock3.html"/>
        <link rel="prev" title="Common APIs" href="input.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Approximate Engineering - Input
          

          
          </a>

          
            
            
              <div class="version">
                2.2.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="../simpleusage.html">Simple Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../simpleusage.html#standard-names">Standard Names</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bluetooth.html">Pairing Controllers over Bluetooth</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="input.html">Common APIs</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Binding - approxeng.input.selectbinder</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#using-an-unsupported-controller">Using an Unsupported Controller</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dualshock3.html">PlayStation 3 Controller Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="dualshock4.html">PlayStation 4 Controller Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="xboxone.html">XBox-One S Controller Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="rockcandy.html">Rock Candy Controller Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="steamcontroller.html">Steam Controller Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="wii.html">Wii Remote Pro Controller Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="wiimote.html">WiiMote Controller Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="pihut.html">PiHut Controller Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="sf30pro.html">8Bitdo SF30Pro/SN30Pro Controller Support</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../addingcontrollers.html">Adding support for a new controller type</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../howtouse.html">Advanced Usage Guide</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Approximate Engineering - Input</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../api.html">API Documentation</a> &raquo;</li>
        
      <li>Binding - approxeng.input.selectbinder</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="binding-approxeng-input-selectbinder">
<span id="binding-reference-label"></span><h1>Binding - approxeng.input.selectbinder<a class="headerlink" href="#binding-approxeng-input-selectbinder" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This replaces the previous approxeng.input.asyncorebinder. The main advantage is that it is compatible with both
Python 2 and 3, removing the only feature of the library that wasn’t working with Python 3, but it’s also much
simpler to use. Where the asyncore binder used device names and paths to try to find an appropriate controller, the
new code uses vendor and product identifiers - these are much more consistent and are guaranteed to be unique. You
don’t need to care about any of these things though, you just need to know that this new version is much easier to
use!</p>
</div>
<p>The binder provides a bridge between the low level operating system representation of your connected controller and the
high level python classes such as <a class="reference internal" href="dualshock3.html#approxeng.input.dualshock3.DualShock3" title="approxeng.input.dualshock3.DualShock3"><code class="xref py py-class docutils literal"><span class="pre">approxeng.input.dualshock3.DualShock3</span></code></a> which your code uses. The binder starts
a new thread to pull events out of the operating system and update your controller object, this is the bit that means
you don’t have to continuously poll the controller, it just updates in the background. It’s also the thread which calls
any functions you’ve bound to buttons as event handlers. You can either manually bind the controller yourself (in which
case you’re also responsible for un-binding it after you’re done!) or you can use the python ‘with’ functionality.</p>
<p>To bind a controller manually you’ll need both an instance of the controller class, and one or more evdev InputDevice
instances from which events should be extracted. The following code shows use of the ‘find_single_controller’ function
to make this reasonably easy:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">approxeng.input.selectbinder</span> <span class="kn">import</span> <span class="n">bind_controller</span>
<span class="kn">from</span> <span class="nn">approxeng.input.dualshock3</span> <span class="kn">import</span> <span class="n">DualShock3</span>
<span class="kn">from</span> <span class="nn">approxeng.input.controllers</span> <span class="kn">import</span> <span class="n">find_single_controller</span>

<span class="c1"># Locate a controller, instantiate it, and retrieve the InputDevice devices with which it&#39;s associated</span>
<span class="c1"># This will raise IOError if it can&#39;t find an appropriate controller</span>
<span class="n">devices</span><span class="p">,</span> <span class="n">controller</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">find_single_controller</span><span class="p">(</span><span class="n">controller_class</span> <span class="o">=</span> <span class="n">DualShock3</span><span class="p">)</span>

<span class="n">unbind_function</span> <span class="o">=</span> <span class="n">bind_controller</span><span class="p">(</span><span class="n">devices</span> <span class="o">=</span> <span class="n">devices</span><span class="p">,</span> <span class="n">controller</span> <span class="o">=</span> <span class="n">controller</span><span class="p">)</span>
<span class="c1"># At this point the joystick object is bound to the device and will receive updates.</span>
<span class="c1"># .... do stuff ....</span>
<span class="c1"># When we&#39;re finished, call the unbind function to free up the resources used by the binder</span>
<span class="n">unbind_function</span><span class="p">()</span>
</pre></div>
</div>
<p>Binding a controller manually works, but there’s a simpler way to handle the process (and one which avoids ever having
to worry about explicitly unbinding the controller!):</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">approxeng.input.selectbinder</span> <span class="kn">import</span> <span class="n">ControllerResource</span>
<span class="kn">from</span> <span class="nn">approxeng.input.dualshock3</span> <span class="kn">import</span> <span class="n">DualShock3</span>

<span class="c1"># Locate a controller, instantiate it, and retrieve the InputDevice devices with which it&#39;s associated</span>
<span class="c1"># This will raise IOError if it can&#39;t find an appropriate controller</span>
<span class="n">devices</span><span class="p">,</span> <span class="n">controller</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">find_single_controller</span><span class="p">(</span><span class="n">controller_class</span> <span class="o">=</span> <span class="n">DualShock3</span><span class="p">)</span>

<span class="k">with</span> <span class="n">ControllerResource</span><span class="p">(</span><span class="n">devices</span> <span class="o">=</span> <span class="n">devices</span><span class="p">,</span> <span class="n">controller</span> <span class="o">=</span> <span class="n">controller</span><span class="p">)</span> <span class="k">as</span> <span class="n">joystick</span><span class="p">:</span>
    <span class="c1"># .... do stuff, the controller is bound to &#39;joystick&#39; which is a DualShock3 instance....</span>
</pre></div>
</div>
<p>On exit from the ‘with’ block the binder is automatically unbound, this includes cases where we break out of the block
because of exceptions or other error conditions. It’s a simpler and more robust way to handle the binding and I suggest
you use it instead of explicitly binding it yourself.</p>
<p>This still requires you to go and find your controller, in most cases you’ll only have one controller of a given kind.
There’s a shorter form of the resource binding that takes advantage of this case:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">approxeng.input.selectbinder</span> <span class="kn">import</span> <span class="n">ControllerResource</span>
<span class="kn">from</span> <span class="nn">approxeng.input.dualshock3</span> <span class="kn">import</span> <span class="n">DualShock3</span>

<span class="c1"># Specifying a controller_class here will search for an attached controller of the given kind</span>
<span class="c1"># If one can&#39;t be found we&#39;ll raise IOError as with the previous code</span>
<span class="k">with</span> <span class="n">ControllerResource</span><span class="p">(</span><span class="n">controller_class</span> <span class="o">=</span> <span class="n">DualShock3</span><span class="p">)</span> <span class="k">as</span> <span class="n">joystick</span><span class="p">:</span>
    <span class="c1"># .... do stuff, the controller is bound to &#39;joystick&#39; which is a DualShock3 instance....</span>
</pre></div>
</div>
<p>This can be made even simpler in the case where you’re not bothered about what kind of controller you have, or you
explicitly want to be able to work with one of a range of controllers. Omitting the controller_class argument will bind
to the first controller of any kind that’s found! This, along with the use of standardised names for the axes and
buttons on the controllers, means you can create a robot that works with PS3, PS4 or XBoxOne controllers based on what
you have lying around, very handy for those PiWars moments when your controller dies and you need to borrow one from the
next table along…</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">approxeng.input.selectbinder</span> <span class="kn">import</span> <span class="n">ControllerResource</span>

<span class="c1"># No controller_class is specified, so we look for any joystick from the list we support, and use the first one!</span>
<span class="c1"># If one can&#39;t be found we&#39;ll raise IOError as with the previous code</span>
<span class="k">with</span> <span class="n">ControllerResource</span><span class="p">()</span> <span class="k">as</span> <span class="n">joystick</span><span class="p">:</span>
    <span class="c1"># .... do stuff, the controller is bound to &#39;joystick&#39; is definitely a subclass of Controller but could be</span>
    <span class="c1"># a PS3, PS4, XBoxOne....</span>
</pre></div>
</div>
<span class="target" id="module-approxeng.input.selectbinder"></span><dl class="class">
<dt id="approxeng.input.selectbinder.ControllerResource">
<em class="property">class </em><code class="descclassname">approxeng.input.selectbinder.</code><code class="descname">ControllerResource</code><span class="sig-paren">(</span><em>controller_class=None</em>, <em>devices=None</em>, <em>controller=None</em>, <em>print_events=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/approxeng/input/selectbinder.html#ControllerResource"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#approxeng.input.selectbinder.ControllerResource" title="Permalink to this definition">¶</a></dt>
<dd><p>General resource which binds a controller on entry and unbinds it on exit. Either a device name (or list of names)
or a path to a device node, typically in /dev/input, can be specified. If neither are supplied, the binding uses
the name property of the controller object.</p>
<dl class="method">
<dt id="approxeng.input.selectbinder.ControllerResource.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>controller_class=None</em>, <em>devices=None</em>, <em>controller=None</em>, <em>print_events=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/approxeng/input/selectbinder.html#ControllerResource.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#approxeng.input.selectbinder.ControllerResource.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new controller resource. The type of the resource is the controller class, so when used in a with block
the bound resource will be a controller from which axis and button values can be read. Note - if all of 
controller_class, devices and controller are None this will attempt to bind to the first controller it can find
which we support. Use this if you’re feeling lazy, or need to be agnostic about what kind of controller your
code uses. Obviously you’ll need to use the standard names for buttons and axes, and make sure you’re not
relying on a particular controller’s physical features, but doing this does give you the option to make use of
any controller you have at the time, whether you developed for that device or not.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>controller_class</strong> – If specified, this class is used to locate the first matching controller of this kind anywhere on the evdev
bus. If this is not None then devices and controller are ignored, and IOError will be raised if we can’t
find an appropriate controller. If this is a list then  match any controllers in the list.</li>
<li><strong>devices</strong> – If controller_classes is None, this can be non-None and should contain at least one instance of InputDevice
to which we should bind to extract evdev events</li>
<li><strong>controller</strong> – If controller_classes is None, this can be an instance of Controller to which events can be pushed</li>
<li><strong>print_events</strong> – Defaults to False, if set to True then all events picked up by the binder will be printed to stdout. Use
this when you’re trying to figure out what events correspond to what axes and buttons!</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><strong>IOError</strong> – If a controller class is specified but we can’t find a connected instance of the class, or nothing has been
specified and we can’t find any controller at all.</li>
<li><strong>ValueError</strong> – If the controller class is not specified, and we have no devices or controller is None</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="approxeng.input.selectbinder.bind_controller">
<code class="descclassname">approxeng.input.selectbinder.</code><code class="descname">bind_controller</code><span class="sig-paren">(</span><em>devices</em>, <em>controller</em>, <em>print_events=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/approxeng/input/selectbinder.html#bind_controller"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#approxeng.input.selectbinder.bind_controller" title="Permalink to this definition">¶</a></dt>
<dd><p>Bind a controller to a set of evdev InputDevice instances</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>devices</strong> – A list of InputDevice instance which should be polled for events</li>
<li><strong>controller</strong> – A Controller instance to which events can be pushed</li>
<li><strong>print_events</strong> – Defaults to False, if set to True then all events picked up by this binder will be printed to stdout</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A function which can be used to stop the event reading thread and unbind from the device</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<div class="section" id="using-an-unsupported-controller">
<h2>Using an Unsupported Controller<a class="headerlink" href="#using-an-unsupported-controller" title="Permalink to this headline">¶</a></h2>
<p>The library’s automatic detection of controllers relies on vendor and product identifiers. These are IDs allocated by
the USB consortium and won’t be duplicated in, for example, a clone PS3 controller like the Rock Candy ones. These
controllers therefore won’t be detected as PS3 controllers even though they’d respond to the same events. You can,
however, explicitly tell the library to route events from a particular evdev InputDevice to a previously constructed
controller instance. This works with either the explicit binding mechanism or with the resource. You’ll have to acquire
the appropriate InputDevice from the evdev APIs first, that part’s up to you, but when you have one you can do this:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">approxeng.input.selectbinder</span> <span class="kn">import</span> <span class="n">ControllerResource</span>
<span class="kn">from</span> <span class="nn">approxeng.input.dualshock3</span> <span class="kn">import</span> <span class="n">DualShock3</span>

<span class="c1"># This is an InputDevice from which events should be pulled</span>
<span class="n">input_device</span> <span class="o">=</span> <span class="o">....</span>

<span class="c1"># Explicitly construct a controller, in this case a PS3 sixaxis. This will receive events from the InputDevice</span>
<span class="c1"># and interpret them. As long as your controller uses the same event codes and axes as those expected by the</span>
<span class="c1"># controller class you should be good to do</span>
<span class="n">controller</span> <span class="o">=</span> <span class="n">DualShock3</span><span class="p">(</span><span class="n">dead_zone</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">hot_zone</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="c1"># Now just use the controller resource to bind the two together, your explicitly created controller instance will</span>
<span class="c1"># be fed events from your InputDevice. The with block returns the controller, so in this case it&#39;s actually the</span>
<span class="c1"># same reference as you just created. You could create the controller instance anonymously as an argument here and</span>
<span class="c1"># use the returned type</span>
<span class="k">with</span> <span class="n">ControllerResource</span><span class="p">(</span><span class="n">devices</span> <span class="o">=</span> <span class="p">[</span><span class="n">input_device</span><span class="p">],</span> <span class="n">controller</span> <span class="o">=</span> <span class="n">controller</span><span class="p">)</span> <span class="k">as</span> <span class="n">joystick</span><span class="p">:</span>
    <span class="c1"># joystick and controller are the same object!</span>
    <span class="c1"># Do stuff as before, if your hardware uses the same codes as the controller class expects it&#39;ll just work.</span>
</pre></div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="dualshock3.html" class="btn btn-neutral float-right" title="PlayStation 3 Controller Support" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="input.html" class="btn btn-neutral" title="Common APIs" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Tom Oinn.
      Last updated on Apr 15, 2018.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'2.2.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>